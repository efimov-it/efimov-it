(function(t){function e(e){for(var n,r,s=e[0],o=e[1],l=e[2],c=0,h=[];c<s.length;c++)r=s[c],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&h.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);u&&u(e);while(h.length)h.shift()();return d.push.apply(d,l||[]),a()}function a(){for(var t,e=0;e<d.length;e++){for(var a=d[e],n=!0,s=1;s<a.length;s++){var o=a[s];0!==i[o]&&(n=!1)}n&&(d.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},i={app:0},d=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=o;d.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"2e56":function(t,e,a){},"2f7e":function(t,e,a){"use strict";var n=a("6dc4"),i=a.n(n);i.a},"2fc0":function(t,e,a){"use strict";var n=a("66be"),i=a.n(n);i.a},"31e9":function(t,e,a){"use strict";var n=a("45ef"),i=a.n(n);i.a},"45ef":function(t,e,a){},4934:function(t,e,a){},5259:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("c975"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=a("8c4f"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-form-wrapper"},[a("form",{staticClass:"login-form"},[t._m(0),a("div",{staticClass:"login-form_body"},[a("h3",{staticClass:"form-header"},[t._v("Авторизация")]),a("form-input",{ref:"email",attrs:{text:"E-mail",placeholder:"you@example.com",name:"email",type:"email",width:"291px"}}),a("form-input",{ref:"password",attrs:{text:"Пароль",placeholder:"Введите ваш пароль",name:"password",type:"password",width:"291px"}}),a("button",{staticClass:"form-submit",attrs:{type:"submit"},on:{click:t.login}},[t._v("Войти в систему")])],1)])])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"login-form_header"},[a("h2",{staticClass:"login-form_header-text"},[t._v(" CLERC ")])])}],s=(a("99af"),a("bc3a")),o=a.n(s),l={host:"https://clercback.dgz.ru"},u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input_text"},[t._v(t._s(t.text))]),"checkbox"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"form-input_object",attrs:{placeholder:t.placeholder,name:t.name,type:"checkbox"},domProps:{checked:Array.isArray(t.value)?t._i(t.value,null)>-1:t.value},on:{change:function(e){var a=t.value,n=e.target,i=!!n.checked;if(Array.isArray(a)){var d=null,r=t._i(a,d);n.checked?r<0&&(t.value=a.concat([d])):r>-1&&(t.value=a.slice(0,r).concat(a.slice(r+1)))}else t.value=i}}}):"radio"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"form-input_object",attrs:{placeholder:t.placeholder,name:t.name,type:"radio"},domProps:{checked:t._q(t.value,null)},on:{change:function(e){t.value=null}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"form-input_object",attrs:{placeholder:t.placeholder,name:t.name,type:t.type},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])},c=[],h={props:["text","placeholder","name","type","width"],data:function(){return{value:""}}},p=h,f=(a("f444"),a("2877")),v=Object(f["a"])(p,u,c,!1,null,null,null),m=v.exports;n["a"].component("form-input",m);var b={methods:{login:function(t){var e=this;t.preventDefault(),""!==this.$refs.email.value&&""!==this.$refs.password.value&&o.a.post(l.host+"/oauth/token","username="+this.$refs.email.value+"&password="+this.$refs.password.value+"&client_id=1&client_secret=c75IGwuqkjrO1RWCE4Ntn4zqpQdpgnEO2wGT9iMT&grant_type=password").then((function(t){sessionStorage.setItem("access_token",t.data.access_token),sessionStorage.setItem("expires_in",t.data.expires_in),sessionStorage.setItem("refresh_token",t.data.refresh_token),sessionStorage.setItem("token_type",t.data.token_type);var a=(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"));o.a.get(l.host+"/api/profile",{headers:{Authorization:a}}).then((function(t){sessionStorage.setItem("role",t.data.data.role),1==t.data.data.role?(e.$emit("update","logIn"),Za.push("/main")):(e.$emit("update","watcher"),Za.push("/watcher"))})).catch((function(t){console.log(t)}))})).catch((function(){alert("Неверный логин или пароль.")}))}},created:function(){var t=this;if(sessionStorage.getItem("access_token")){var e=(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"));o.a.get(l.host+"/api/profile",{headers:{Authorization:e}}).then((function(e){sessionStorage.setItem("role",e.data.data.role),1==e.data.data.role?(t.$emit("update","logIn"),Za.push("/main")):(t.$emit("update","watcher"),Za.push("/watcher"))})).catch((function(t){console.log(t)}))}}},g=b,_=(a("8fbf"),Object(f["a"])(g,d,r,!1,null,null,null)),y=_.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-page-wrapper"},[a("breadcrumbs",{attrs:{data:t.breadCrumbs},on:{updateLinks:t.updateLinks,goToMain:t.goToMain}}),a("div",{staticClass:"main-page-content"},[a("router-view",{on:{update:t.update}})],1)],1)},x=[],A=(a("a434"),a("b0c0"),a("9911"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"breadcrumbs"},[a("a",{staticClass:"back-link breadcrumbs_back-link",style:"visibility: "+[t.data.length>1?"visible":"hidden"],on:{click:function(e){return t.goToMain()}}},[t._v("На главную")]),a("ul",{staticClass:"breadcrumbs_list"},t._l(t.data,(function(e,n){return a("li",{key:n,on:{click:function(a){0==n?t.goToMain:n<t.data.length-1&&t.goToLink(e.link,n)}}},[t._v(" "+t._s(e.name)+" ")])})),0)])}),S=[],D={props:["data"],data:function(){return{}},methods:{goToMain:function(){this.$emit("goToMain"),1==sessionStorage.getItem("role")?Za.push("/main/"):Za.push("/watcher/objects/")},goToLink:function(t,e){this.$emit("updateLinks",e),Za.push(t)}}},k=D,I=(a("70cd"),Object(f["a"])(k,A,S,!1,null,null,null)),$=I.exports;n["a"].component("breadcrumbs",$);var C={data:function(){return{breadCrumbs:[{name:"Контракты",link:{path:"/main/"}}]}},methods:{update:function(t){switch(t.event){case"openDeal":this.breadCrumbs.push({name:t.name,link:t.link});break}},goToMain:function(){this.breadCrumbs=[{name:"Контракты",link:{path:"/main/"}}]},updateLinks:function(t){this.breadCrumbs.splice(t+1,this.breadCrumbs.length-t-1)}},mounted:function(){this.$emit("update","logIn")},updated:function(){("/main/"==this.$route.path||"/main"==this.$route.path)&this.breadCrumbs.length>1&&(this.breadCrumbs=[{name:"Контракты",link:{path:"/main/"}}])}},E=C,j=(a("b08b"),Object(f["a"])(E,w,x,!1,null,null,null)),T=j.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-page-wrapper"},[a("breadcrumbs",{attrs:{data:t.breadCrumbs}}),a("div",{staticClass:"main-page-content"},[a("div",{staticClass:"scroll-area"},[a("div",[a("button",{staticClass:"add-row add-new-deal",on:{click:t.add}},[t._v("Добавить нового пользователя")])]),a("table-view",{ref:"table",staticStyle:{width:"auto",height:"auto"},attrs:{headers:t.tableHeaders,data:t.data},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)])],1)},P=[],L=(a("7db0"),a("4160"),a("fb6a"),a("d3b7"),a("159b"),a("ddb0"),a("4b70")),z=a.n(L),R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-view-wrapper"},[a("scroll-bar",{staticClass:"table-view",attrs:{settings:{suppressScrollY:!0}}},[void 0!=this.data?a("header",{staticClass:"table-view_headers",style:t.columns?t.columns:"grid-template-columns: repeat("+this.headers.length+", minmax(300px, 1fr)) 40px;"},t._l(this.headers,(function(e,n){return a("div",{key:n,ref:"header",refInFor:!0,class:"table-view_header"+(t.noSort?" no-sort":""),on:{click:function(e){!t.noSort&&t.sort(n)}}},[t._v(" "+t._s(e)+" ")])})),0):t._e(),void 0!=this.data?a("scroll-bar",{class:"table-view_body"+[this.firstColumn?" table-view_body__first-column":""],attrs:{settings:{wheelPropagation:!0,suppressScrollX:!0}}},[t._l(this.data,(function(e,n){return a("div",{key:n,staticClass:"table-view_row"},[a("row-view",{ref:e.id,refInFor:!0,attrs:{index:n,rowData:e,alwaysUpdate:t.alwaysUpdate,inRowAdd:t.inRowAdd,columnsWidth:t.columns?t.columns:"grid-template-columns: repeat("+[void 0!=e.data?Object.keys(e.data).length:0]+", minmax(300px, 1fr)) 40px;",subTableColumns:t.subTableColumns},on:{checkboxChange:t.checkboxChange,rowClick:t.rowClick,addRow:t.addRow,addRowInSubTable:t.addRowInSubTable,addInnerDate:t.addInnerDate}})],1)})),1==this.inRowAdd?a("div",{staticClass:"new-row-button-wrapper"},[-1!=t.manyQueries?a("button",{staticClass:"add-row",staticStyle:{"margin-right":"30px"},on:{click:t.loadNewData}},[t._v("Загрузить ещё...")]):t._e(),1==t.role?a("button",{staticClass:"new-row-button",on:{click:function(e){return t.addRow()}}},[t._v("Добавить новую запись")]):t._e()]):t._e()],2):t._e()],1)],1)},N=[],B=(a("b64b"),a("ac1f"),a("5319"),a("1276"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{class:"table-view_row-content"+[t.rowDataBinding.isGrey?" color-grey":""]},[t.isEdit?t._e():a("div",{style:"display: grid; "+t.columnsWidth},t._l(t.rowDataBinding.data,(function(e,n){return a("div",{key:n,staticClass:"table-view_cell",on:{click:function(e){return t.rowClick()}}},["text"==e.type|"number"==e.type|"date"==e.type|"password"==e.type|"email"==e.type|"select"==e.type?a("span",[t._v(" "+t._s(e.value)+" ")]):t._e(),"checkbox"==e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"tableCell.value"}],staticClass:"table-view_checkbox",attrs:{id:"checkBox"+t.index,type:"checkbox"},domProps:{checked:Array.isArray(e.value)?t._i(e.value,null)>-1:e.value},on:{change:[function(a){var n=e.value,i=a.target,d=!!i.checked;if(Array.isArray(n)){var r=null,s=t._i(n,r);i.checked?s<0&&t.$set(e,"value",n.concat([r])):s>-1&&t.$set(e,"value",n.slice(0,s).concat(n.slice(s+1)))}else t.$set(e,"value",d)},function(e){return t.checkboxChange(t.index)}]}}):t._e(),"checkbox"==e.type?a("label",{attrs:{for:"checkBox"+t.index}}):t._e(),"presentation"==e.type?a("div",[a("presentation",{attrs:{data:e.value}})],1):t._e(),"files"==e.type?a("div",{staticClass:"table-view_cell-links"},t._l(e.value,(function(e,n){return a("a",{key:n,staticClass:"table-view_cell-link",attrs:{title:"Нажмите чтобы посмотреть или скачать",href:t.host+e.url,target:"_blank"}},[t._v(" "+t._s(e.name)+"."+t._s(e.extension)+" ")])})),0):t._e()])})),0),t.isEdit?a("div",{style:"display: grid; "+t.columnsWidth},t._l(t.rowDataBinding.data,(function(e,n){return a("div",{key:n},["number"==e.type?a("input",{ref:"inputs",refInFor:!0,staticClass:"table-view_cell",attrs:{title:e.value,type:"number"},domProps:{value:e.value?parseFloat(e.value.replace(/\s/g,"").replace(/,/g,".")):"",checked:e.value}}):t._e(),"date"==e.type?a("input",{ref:"inputs",refInFor:!0,staticClass:"table-view_cell",attrs:{title:e.value,type:"date"},domProps:{value:[null!=e.value?e.value.split(".")[2]+"-"+e.value.split(".")[1]+"-"+e.value.split(".")[0]:""],checked:e.value}}):t._e(),"password"==e.type?a("input",{ref:"inputs",refInFor:!0,staticClass:"table-view_cell",attrs:{title:e.value,type:"password"},domProps:{value:e.value,checked:e.value}}):t._e(),"email"==e.type?a("input",{ref:"inputs",refInFor:!0,staticClass:"table-view_cell",attrs:{title:e.value,type:"email"},domProps:{value:e.value,checked:e.value}}):t._e(),"text"==e.type?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"tableCell.value"}],ref:"inputs",refInFor:!0,staticClass:"table-view_cell-textarea",attrs:{title:e.value},domProps:{value:e.value},on:{input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}}):t._e(),"select"==e.type?a("select",{ref:"inputs",refInFor:!0,staticClass:"table-view_cell-select"},t._l(e.keys,(function(e,n){return a("option",{key:n,domProps:{value:n}},[t._v(" "+t._s(e)+" ")])})),0):t._e(),"presentation"==e.type?a("div",[a("presentation",{attrs:{data:e.value}})],1):t._e(),"files"==e.type?a("div",{staticClass:"table-view_cell-links__edit"},[t._l(e.value,(function(n,i){return a("span",{key:i,staticClass:"table-view_cell-link"},[t._v(" "+t._s(n.name)+"."+t._s(n.extension)+" "),a("button",{staticClass:"remove-file",attrs:{title:"Удалить файл"},on:{click:function(a){return t.removeFile(n.id,e,i)}}})])})),a("button",{staticClass:"add-row",on:{click:function(a){return t.loadFile(e)}}},[t._v("Загрузить файл")])],2):t._e()])})),0):t._e(),t.rowDataBinding.options&&!t.isEdit?a("more-tools",{attrs:{options:t.rowDataBinding.options,id:t.rowDataBinding.id},on:{"option-click":t.optionClick}}):t._e(),t.isEdit?a("div",{ref:"endEditBtn",staticClass:"more-tools save-btn",attrs:{title:"Сохранить изменения"}}):t._e()],1),void 0!=this.rowData.subTable?a("div",{class:"subtable "+[1==t.subTableState?"active":""]},[a("div",{staticClass:"table-wrapper color-grey"},[a("table-view",{ref:"subTable"+this.rowData.id,attrs:{headers:this.rowData.subTable.headers,data:this.rowData.subTable.rows,inRowAdd:t.inRowAdd,columns:t.subTableColumns},on:{addRow:t.addRowInSubTable,sort:t.sort}})],1)]):t._e(),a("input",{ref:"fileDialog",staticClass:"input-dialog",attrs:{type:"file"}})])}),F=[],U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"presentation"},t._l(t.data,(function(e,n){return a("div",{key:n,staticClass:"presentation-wrapper"},[a("div",{staticClass:"presentation_date"},[t._v(" "+t._s(new Date(e.date.replace(/"/g,"")).toLocaleDateString())+" ")]),a("ul",{staticClass:"presentation_note"},t._l(e.note.split("<br />"),(function(e,n){return a("li",{key:n},[t._v(" "+t._s(e)+" ")])})),0)])})),0)},G=[],W={props:["data"],methods:{updateJSON:function(){this._props.data.forEach((function(t){t.note=t.note.replace(/["|"]|"/g,"").replace(/","/,"<br />"),t.note=t.note.replace(/\\r\\n|\\n/g,"<br />"),t.date=t.date.replace('"',"")}))}},mounted:function(){this.updateJSON()},updated:function(){this.updateJSON()}},M=W,Y=(a("f1fc"),Object(f["a"])(M,U,G,!1,null,null,null)),H=Y.exports;n["a"].component("table-view",rt),n["a"].component("presentation",H);var J={props:["rowData","inRowAdd","index","columnsWidth","subTableColumns","alwaysUpdate"],data:function(){return{host:"",isEdit:!1,event:null,subTableState:!1,rowDataBinding:[],AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token")),dataBeforeEdit:[]}},methods:{sort:function(t){var e=this;this.rowData.subTable.rows=[],this.$nextTick().then((function(){e.rowData.subTable.rows=t}))},checkboxChange:function(t){this.$emit("checkboxChange",t)},optionClick:function(t){switch(t.data.id){case"edit":this.event=t.data.event,this.isEdit=!0;break;case"add":t.data.event();break;case"editPresentation":t.data.event(t.id);break;case"delet":t.data.event(t.id);break;case"import":t.event(this.rowDataBinding.id);break}},rowClick:function(){void 0==this.rowData.subTable?this.$emit("rowClick",this.rowDataBinding.id):this.subTableState=!this.subTableState},addRow:function(t){this.$emit("addRow",t)},addRowInSubTable:function(){this.$emit("addRowInSubTable",this.rowData.id)},addInnerDate:function(){this.$emit("addInnerDate",this.rowData.id,this.$refs.newInnerDate[0].value)},loadFile:function(t){var e=this,a=this.$refs.fileDialog;a.onchange=function(){var n=new FormData;n.append("file",a.files[0]),o()({method:"post",url:l.host+"/api/"+e.rowData.data.files.model+"/"+e.rowData.id+"/files",data:n,headers:{Authorization:e.AuthStr}}).then((function(e){""==t.value&&(t.value=[]),t.value.push(e.data.data)})).catch((function(t){alert("Ошибка!\r\rНе удалось загрузить файл.\r\rИнформация об ошибке:\r"+t)})),a.value=""},a.click()},removeFile:function(t,e,a){confirm("Вы действительно хотите удалить этот файл?")&&o()({method:"delete",url:l.host+"/api/files/"+t,headers:{Authorization:this.AuthStr}}).then().catch((function(t){"true"==t.response.data.error.messages[0]?e.value.splice(a,1):alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+t)}))},endEdit:function(){var t=[];this.$forceUpdate(),this.$refs.inputs.forEach((function(e){t.push(e.value)})),this.isEdit=!1,this.event(t,this.rowData.id)}},created:function(){this.rowDataBinding=this.rowData,this.host=l.host},beforeUpdate:function(){var t=this;void 0!=this.$refs.inputs&&this.isEdit&&this.$refs.inputs.forEach((function(e){t.dataBeforeEdit.push(e.value)}))},updated:function(){var t=this,e=this;e.isEdit&&(e.$refs.inputs.forEach((function(a,n){a.onkeydown=function(a){13==a.keyCode&&t.endEdit(),27==a.keyCode&&(e.isEdit=!1)},t.dataBeforeEdit.length>0&&"date"==a.type&&(a.value=t.dataBeforeEdit[n])})),e.$refs.endEditBtn.onclick=function(){t.endEdit()},this.dataBeforeEdit=[])}},Q=J,q=(a("c63c"),Object(f["a"])(Q,B,F,!1,null,null,null)),K=q.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:"more-tools"+[t.state?" more-tools__active":""],on:{click:function(e){t.state=!t.state},mouseleave:function(e){t.state=!1}}},[a("ul",{staticClass:"more-tools_list",style:t.customStyle?t.customStyle:""},t._l(this.options,(function(e,n){return a("li",{key:n,class:"more-tools_list-item more-tools_list-item__"+e.id,style:void 0!=t.customStyle&0==n?"border-right: 1px solid #ffffff;":"",on:{click:function(a){return t.setClick(e)}}},[t._v(t._s(e.text))])})),0)])},V=[],Z={props:["options","id","customStyle"],data:function(){return{state:!1}},methods:{setClick:function(t){this.state&&this.$emit("option-click",{data:t,id:this.id})}}},tt=Z,et=(a("7596"),Object(f["a"])(tt,X,V,!1,null,null,null)),at=et.exports;n["a"].component("scroll-bar",z.a),n["a"].component("row-view",K),n["a"].component("more-tools",at);var nt={props:["data","headers","firstColumn","inRowAdd","columns","subTableColumns","groupBy","sortBy","alwaysUpdate","noSort"],data:function(){return{rowsCount:0,currentSort:"",sortDirection:-1,sortedData:[],grouped:!1,sortByGroup:!1,manyQueries:-1,role:0}},methods:{checkboxChange:function(t){this.$emit("checkboxChange",t)},rowClick:function(t){this.$emit("rowClick",t)},addRow:function(t){this.$emit("addRow",t)},addRowInSubTable:function(t){this.$emit("addRowInSubTable",t)},sort:function(t){var e,a=this,n=Object.keys(this.data[0].data)[t];if(0==this.sortedData.length)this.data.forEach((function(t){a.sortedData.push(t)}));else if(this.grouped){if(this.sortByGroup)this.sortDirection=1==this.sortDirection?-1:1,-1==this.sortDirection?(this.$refs.header[t].className+=" table-view_header__sorted",this.$refs.header[t].classList.remove("table-view_header__sorted-up"),this.$refs.header[t].className+=" table-view_header__sorted-down"):(this.$refs.header[t].className+=" table-view_header__sorted",this.$refs.header[t].className+=" table-view_header__sorted-up",this.$refs.header[t].classList.remove("table-view_header__sorted-down"));else if(-1==this.sortDirection)return void i(this)}else{if(1!=this.sortDirection)return void i(this);this.sortDirection}function i(t){-1==t.sortDirection&&(t.$emit("sort",t.sortedData),t.currentSort="",t.sortBy!=n&&(t.grouped=!1),t.sortedData=[],t.$refs.header.forEach((function(t){t.classList.remove("table-view_header__sorted-up"),t.classList.remove("table-view_header__sorted-down"),t.classList.remove("table-view_header__sorted")})))}if(e="number"==this.data[0].data[n].type?function(t,e){if(null==t.data[n].value||null==e.data[n].value)return-1;var i=parseFloat(t.data[n].value.replace(/\s/g,""))-parseFloat(e.data[n].value.replace(/\s/g,""));return i<0?-1*a.sortDirection:i>0?a.sortDirection:0}:"date"==this.data[0].data[n].type?function(t,e){""!=t.data[n].value?(t=t.data[n].value.split("."),t=t[2]+"-"+t[1]+"-"+t[0]):t=0,""!=e.data[n].value?(e=e.data[n].value.split("."),e=e[2]+"-"+e[1]+"-"+e[0]):e=0;var i=new Date(t).getTime()/864e5-new Date(e).getTime()/864e5;return a.sortDirection*i/Math.abs(i)}:""==this.data[0].data[n].value.replace(/\.|\d|\s/g,"")&&this.data[0].data[n].value.length>2?function(t,e){t=t.data[n].value.split("."),e=e.data[n].value.split(".");for(var i=t.length>e.length?t.length:e.length,d=0;d<i;d++)if(parseInt(t[d])!=parseInt(e[d]))return parseInt(t[d])>parseInt(e[d])?a.sortDirection:parseInt(t[d])<parseInt(e[d])?-1*a.sortDirection:0}:function(t,e){return t.data[n].value>e.data[n].value?a.sortDirection:t.data[n].value<e.data[n].value?-1*a.sortDirection:0},void 0!=this.groupBy&void 0!=this.sortBy)if(n==this.sortBy)if(this.grouped){var d,r=[],s=null;this.data.forEach((function(t,e){function n(a){void 0!=d&&r.push(d),d={groupName:t.data[a.groupBy].value,rows:[]},d.rows.push(t),s=t.data[a.groupBy].value,e==a.data.length-1&&r.push(d)}null!=s&&t.data[a.groupBy].value==s?(d.rows.push(t),e==a.data.length-1&&r.push(d)):n(a)})),r.forEach((function(t){t.rows.sort(e)}));var o=[];r.forEach((function(t){t.rows.forEach((function(t){o.push(t)}))})),this.$emit("sort",o)}else l(this);else l(this);else l(this);function l(a){var n=0;for(var i in a.data[0].data){if(n==t){a.$refs.header.forEach((function(t){t.classList.remove("table-view_header__sorted-up"),t.classList.remove("table-view_header__sorted-down"),t.classList.remove("table-view_header__sorted")}));var d=void 0;a.sortedData.length>0&-1==a.sortDirection?(a.currentSort=i,d=a.data.sort(e),a.$refs.header[t].className+=" table-view_header__sorted",a.$refs.header[t].classList.remove("table-view_header__sorted-up"),a.$refs.header[t].className+=" table-view_header__sorted-down",a.sortDirection=1):(d=a.data.sort(e),a.$refs.header[t].className+=" table-view_header__sorted",a.$refs.header[t].classList.remove("table-view_header__sorted-down"),a.$refs.header[t].className+=" table-view_header__sorted-up",a.sortDirection=-1),a.$emit("sort",d)}n++}}this.groupBy==n?(this.grouped=!0,this.sortByGroup=!1):1==this.grouped&&(this.sortBy!=n?this.grouped=!1:this.sortByGroup=!0)},loadNewData:function(){this.$emit("loadData",this.manyQueries)},addInnerDate:function(t,e){this.$emit("addInnerDate",t,e)}},created:function(){this.role=sessionStorage.getItem("role")?sessionStorage.getItem("role"):0,void 0!=this.data?this.rowsCount=this.data.length:this.rowsCount=0},updated:function(){this.rowsCount<this.data.length&&this.$emit("update")}},it=nt,dt=(a("640a"),Object(f["a"])(it,R,N,!1,null,null,null)),rt=dt.exports;n["a"].component("scroll-bar",z.a),n["a"].component("breadcrumbs",$),n["a"].component("table-view",rt);var st={data:function(){return{breadCrumbs:[{name:"Пользователи",link:{path:"/users"}},""],tableHeaders:["Логин/E-mail","Фамилия имя","Пароль","Роль","Примечание"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){if(null==this.lastAddedId){this.lastAddedId=-1;var t=this.data;t.unshift({id:-1,options:[{id:"edit",text:"Редактировать",event:this.edit},{id:"delet",text:"Удалить",event:this.delet}],data:{email:{value:"",type:"text"},fullname:{value:"",type:"text"},password:{value:"",type:"password"},role:{value:"",type:"select",keys:["Наблюдатель","Администратор"]},note:{value:"",type:"text"}}}),this.affterDeleting=t}},edit:function(t,e){var a=this;if(null!=t[2]){if(t[2].length<6)return alert("Пароль должен быть не менее 6 символов."),this.lastAddedId=e,void this.update();if("••••••••••••••••"==t[2].length)return alert("Пожалуйста, укажите корректный пароль."),this.lastAddedId=e,void this.update()}var n,i=["email","fullname","password","role","company"],d="";t.forEach((function(t,e){null!=t&&(d+="&"+i[e]+"="+t,2==e&&(d+="&password_confirmation="+t))})),-1!=this.lastAddedId?n=o.a.put(l.host+"/api/users/"+e,d.substring(1),{headers:{Authorization:this.AuthStr}}):(n=o.a.post(l.host+"/api/users",d.substring(1),{headers:{Authorization:this.AuthStr}}),this.lastAddedId=null),n.then((function(t){a.data.find((function(n){n.id==e&&(n.id=t.data.data.id,n.data.email.value=t.data.data.email,n.data.fullname.value=t.data.data.fullname,n.data.password.value="••••••••••••••••",n.data.role.value=0!=t.data.data.role?"Администратор":"Наблюдатель",n.data.note.value=t.data.data.company,a.lastAddedId=null)}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить этого пользователя?")&&o()({method:"delete",url:l.host+"/api/users/"+t,headers:{Authorization:this.AuthStr}}).then((function(){})).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},load:function(t){var e=this,a=this;t=void 0!=t?t:l.host+"/api/users",o.a.get(t,{headers:{Authorization:this.AuthStr}}).then((function(t){for(var n=t.data.data,i=0;i<n.length;i++){var d={};d.id=n[i].id,d.data={},d.data.email={},d.data.email.value=n[i].email,d.data.email.type="text",d.data.fullname={},d.data.fullname.value=n[i].fullname,d.data.fullname.type="text",d.data.password={},d.data.password.value="••••••••••••••••",d.data.password.type="password",d.data.role={},d.data.role.value=1==n[i].role?"Администратор":"Наблюдатель",d.data.role.type="select",d.data.role.keys=["Наблюдатель","Администратор"],d.data.note={},d.data.note.value=n[i].company,d.data.note.type="text",d.options=[{event:e.edit,id:"edit",text:"Редактировать"},{id:"delet",text:"Удалить",event:e.delet}],a.data.push(d)}null!=t.data.links.next&&e.load(t.data.links.next)}))}},created:function(){this.load()}},ot=st,lt=(a("2f7e"),Object(f["a"])(ot,O,P,!1,null,null,null)),ut=lt.exports,ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scroll-area"},[a("div",[a("button",{staticClass:"add-row add-new-deal",on:{click:t.add}},[t._v("Добавить новый контракт")])]),a("table-view",{ref:"table",staticStyle:{width:"auto",height:"auto"},attrs:{headers:t.tableHeaders,data:t.data,firstColumn:!0},on:{sort:t.sort,rowClick:t.openDeal,addRow:t.add,update:t.update}})],1)},ht=[],pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tab-view",{on:{update:t.update}})},ft=[],vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-view"},[a("div",{staticClass:"tab-view_tabs"},t._l(t.tabs,(function(e,n){return a("tab",{key:n,ref:"tab"+e.id,refInFor:!0,attrs:{data:e},on:{tabClick:t.tabClick}})})),1),a("scroll",{staticClass:"tab-view_content",attrs:{settings:{suppressScrollX:!0}}},[a("router-view")],1)],1)},mt=[],bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:"tab-view_tabs-item"+[t.selected?" tab-view_tabs-item__active":""],on:{click:function(e){return t.tabClick(t.data.id)}}},[t._v(" "+t._s(t.data.name)+" ")])},gt=[],_t={props:["data"],data:function(){return{selected:!1}},methods:{tabClick:function(t){this.selected=!0,this.$emit("tabClick",t)}}},yt=_t,wt=(a("be4e"),Object(f["a"])(yt,bt,gt,!1,null,null,null)),xt=wt.exports;n["a"].component("scroll",z.a),n["a"].component("tab",xt);var At={data:function(){return{tabs:[{id:0,name:"Характеристики судна",path:"/ship-info"},{id:1,name:"Банковская гарантия",path:"/bank-guarantees"},{id:2,name:"Лимиты бюджетных обязательств",path:"/limits"},{id:3,name:"Объекты",path:"/objects"},{id:4,name:"Этапы платежей",path:"/payment-stages"},{id:5,name:"Ключевые события",path:"/key-events"},{id:6,name:"Претензионная работа",path:"/claim-work"},{id:7,name:"Судебная работа",path:"/judical-work"},{id:8,name:"Кассовое исполнение",path:"/cash-execution"}],AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token")),path:""}},methods:{tabClick:function(t){var e=this;this.tabs.forEach((function(a){a.id!=t?e.$refs["tab"+a.id][0].selected=!1:e.$route.path!=e.path+a.path&&Za.replace("/deal/"+Za.currentRoute.params.id+a.path)}))},loadDealNumber:function(){var t=this;o()({method:"get",url:"https://clercback.dgz.ru/api/contracts/"+Za.currentRoute.params.id,headers:{Authorization:this.AuthStr}}).then((function(e){t.$emit("update",{name:e.data.data.number?e.data.data.number:"Номер не указан",link:"/deal/"+Za.currentRoute.params.id,event:"openDeal"})})).catch((function(){t.$emit("update",{name:"Номер не указан",link:"/deal/"+Za.currentRoute.params.id,event:"openDeal"})}))}},mounted:function(){var t=this;1==this.$parent.$parent.$children[0].data.length&&this.loadDealNumber(),this.path=this.$route.path;var e=this.path.split("/");if(void 0!=e[3]){var a="/"+e[3];this.tabs.find((function(e){e.path==a&&(t.$refs["tab"+e.id][0].selected=!0)}))}else this.$refs.tab0[0].selected=!0;3!=e.length&&4!=e.length||""==e[3]|void 0==e[3]&&Za.push(this.path+"/ship-info")}},St=At,Dt=(a("31e9"),Object(f["a"])(St,vt,mt,!1,null,null,null)),kt=Dt.exports;n["a"].component("tab-view",kt);var It={data:function(){return{}},methods:{update:function(t){this.$emit("update",t)}}},$t=It,Ct=Object(f["a"])($t,pt,ft,!1,null,null,null),Et=Ct.exports;n["a"].component("scroll-bar",z.a),n["a"].component("table-view",rt),n["a"].component("deal-view",Et);var jt={data:function(){return{tableHeaders:["Наименование","Номер Гос. контракта","Дата подписание контракта","Контрагент","Цена котракта (₽)","Окончание выполнения работ","Примечание"],data:[],lastAddedId:null,affterDeleting:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},openDeal:function(t){var e;this.data.find((function(a){a.id!=t||(e=a.data.number.value)})),this.$emit("update",{event:"openDeal",name:e||"Номер не указан",link:{path:"/deal/"+t,params:{dealId:t}}}),this.$router.push({path:"/deal/"+t+"/ship-info",params:{dealId:t}})},refreshToken:function(){o.a.post(l.host+"/oauth/token","refresh_token="+sessionStorage.getItem("refresh_token")+"&client_id=1&client_secret=c75IGwuqkjrO1RWCE4Ntn4zqpQdpgnEO2wGT9iMT&grant_type=password").then((function(t){sessionStorage.setItem("access_token",t.data.access_token),sessionStorage.setItem("expires_in",t.data.expires_in),sessionStorage.setItem("refresh_token",t.data.refresh_token),sessionStorage.setItem("token_type",t.data.token_type)})).catch((function(t){console.log(t)}))},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/contracts","",{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{event:t.delet,id:"delet",text:"Удалить"}],data:{name:{value:"",type:"text"},number:{value:"",type:"text"},dateStart:{value:"",type:"date"},contragent:{value:"",type:"text"},price:{value:"",type:"number"},dateEnd:{value:"",type:"date"},note:{value:"",type:"text"}}}),t.affterDeleting=a}))},edit:function(t,e){for(var a=this,n=["name","number","date","counterpart","price","deadline","note"],i={},d=0;d<t.length;d++)null!=t[d]&void 0!=t[d]&""!=t[d]|2==d|5==d&&(i[n[d]]=t[d]);o.a.put(l.host+"/api/contracts/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){n.data.number.value=t.data.data.number,n.data.name.value=t.data.data.name,n.data.contragent.value=t.data.data.counterpart,n.data.price.value=null!=t.data.data.price?parseFloat(t.data.data.price).toLocaleString():"";var i=null!=t.data.data.date?new Date(t.data.data.date).toLocaleDateString():"",d=null!=t.data.data.deadline?new Date(t.data.data.deadline).toLocaleDateString():"";n.data.dateStart.value=i,n.data.dateEnd.value=d,n.data.note.value=t.data.data.note,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить контракт?")&&o.a.delete(l.host+"/api/contracts/"+t,{headers:{Authorization:this.AuthStr}}).then((function(){})).catch((function(a){if("true"!=a.response.data.error.messages[0])alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a);else for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n,e.lastAddedId=null)}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},import:function(){},loadDeal:function(t,e){var a=this;void 0==e&&(e=[]),t=void 0==t?l.host+"/api/contracts":t,o.a.get(t,{headers:{Authorization:this.AuthStr}}).then((function(t){for(var n=t.data.data,i=0;i<n.length;i++){var d={};d.id=n[i].id,d.status=!0,d.options=[{event:a.edit,id:"edit",text:"Редактировать"}],d.status||d.options.push({event:a.import,id:"import",text:"Импортировать"}),d.options.push({event:a.delet,id:"delet",text:"Удалить"}),d.data={},d.data.name={},d.data.name.value=n[i].name,d.data.name.type="text",d.data.number={},d.data.number.value=n[i].number,d.data.number.type="text";var r=null!=n[i].date?new Date(n[i].date).toLocaleDateString():"";d.data.dateStart={},d.data.dateStart.value=r,d.data.dateStart.type="date",d.data.contragent={},d.data.contragent.value=n[i].counterpart,d.data.contragent.type="text",d.data.price={},d.data.price.value=null!=n[i].price?parseFloat(n[i].price).toLocaleString():"",d.data.price.type="number";var s=null!=n[i].deadline?new Date(n[i].deadline).toLocaleDateString():"";d.data.dateEnd={},d.data.dateEnd.value=s,d.data.dateEnd.type="date",d.data.note={},d.data.note.value=n[i].note,d.data.note.type="text",e.push(d)}null!=t.data.links.next?a.loadDeal(t.data.links.next,e):(e.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),a.data=e)}))}},created:function(){this.loadDeal()}},Tt=jt,Ot=(a("c466"),Object(f["a"])(Tt,ct,ht,!1,null,null,null)),Pt=Ot.exports,Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-page-wrapper"},[a("breadcrumbs",{attrs:{data:this.breadCrumbs},on:{goToMain:t.goToMain}}),a("router-view",{staticClass:"main-page-content",on:{update:t.update}})],1)},zt=[],Rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tables-view"},[a("div",[a("div",{staticClass:"tables-view_header"},[t._l(t.pages,(function(e,n){return a("button",{key:n,staticClass:"tables-view_tab",class:[n==t.current?"tables-view_tab__active":""],on:{click:function(a){return t.buttonClick(n,e.path)}}},[t._v(" "+t._s(e.text)+" ")])})),t.canImport&1==t.role?a("button",{staticClass:"tables-view_tab tables-view_tab__right tables-view_tab__active",on:{click:t.importExcel}},[t._v("Импорт из Excel")]):t._e(),t.canImport&1==t.role?a("button",{staticClass:"tables-view_tab tables-view_tab__right tables-view_tab__active",on:{click:t.exportExcel}},[t._v("Экспорт в Excel")]):t._e()],2)]),a("router-view",{on:{presentation:t.presentation}}),a("input",{ref:"inputDialog",staticClass:"input-dialog",attrs:{type:"file"}}),a("presentation-form",{ref:"presentation"})],1)},Nt=[],Bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!=t.data?a("div",{class:"modal-wrapper "+[t.isActive?" modal-wrapper__active":""]},[a("div",{staticClass:"modal-dark-background"}),a("div",{staticClass:"modal-window"},[a("header",{staticClass:"modal-window_header"},[t._v(t._s(t.data.title)+" | Редактирование предъявлений "),a("button",{staticClass:"modal-window_close",on:{click:t.close}})]),a("div",{staticClass:"presentation-form"},[a("button",{staticClass:"add-row",on:{click:t.addPresentation}},[t._v("Добавить новое предъявление")]),a("table",{staticClass:"editble-table"},[t._m(0),a("tbody",[0==t.data.notes.length?a("tr",[a("td",{staticStyle:{padding:"40px","text-align":"center"},attrs:{colspan:"3"}},[t._v("Для "+t._s(t.data.title)+" нет созданных предъявлений")])]):t._e(),t._l(t.data.notes,(function(e,n){return a("tr",{key:n},[a("td",{attrs:{align:"left",valign:"top"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.date,expression:"pres.date"}],staticClass:"table-view_cell",attrs:{type:"date"},domProps:{value:e.date},on:{input:function(a){a.target.composing||t.$set(e,"date",a.target.value)}}})]),a("td",{attrs:{align:"left",valign:"top"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.note,expression:"pres.note"}],staticClass:"table-view_cell-textarea",staticStyle:{"max-width":"400px"},domProps:{value:e.note},on:{input:function(a){a.target.composing||t.$set(e,"note",a.target.value)}}})]),a("td",{staticStyle:{padding:"20px 0px"}},[a("button",{staticClass:"modal-window_close",staticStyle:{width:"20px",height:"20px"},attrs:{title:"Удалить запись"},on:{click:function(e){return t.deletePresentation(n)}}})])])}))],2)]),a("div",{staticClass:"save-button-wrapper"},[a("button",{staticClass:"add-row",on:{click:t.saveAndClose}},[t._v("Сохранить и закрыть")])])])])]):t._e()},Ft=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("td",{attrs:{width:"250px"}},[t._v("Дата предъявления")]),a("td",{attrs:{colspan:"2"}},[t._v("Содержание предъявления")])])])}];n["a"].component("scroll-bar",z.a);var Ut={data:function(){return{deleted:[],isActive:!1,id:null,model:null,data:null,callback:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{close:function(){this.isActive=!1,this.id=null,this.model=null,this.data=null},option:function(t){t.data.event(t.id)},loadData:function(){var t=this;o()({method:"get",url:l.host+"/api/"+this.model+"/"+this.id+"/",headers:{Authorization:this.AuthStr}}).then((function(e){t.data={title:""},"reports"==t.model?o()({method:"get",url:l.host+"/api/constructionCertificates/"+e.data.data.construction_certificate_id,headers:{Authorization:t.AuthStr}}).then((function(e){t.data.title="УП № "+e.data.data.number})):"mooringCertificates"==t.model?t.data.title="УШ № "+e.data.data.number:t.data.title="УХ № "+e.data.data.number;var a=[];e.data.data.presentations.forEach((function(t){var e="";try{var n=JSON.parse(t.note);n.forEach((function(t){e+=t+"\r\n"}))}catch(i){e=t.note.replace(/"/g,"").replace(/\\n/g,"\n")}a.push({id:t.id,date:t.date.replace(/"/g,""),note:e})})),t.data.notes=a}))},addPresentation:function(){this.data.notes.push({id:-1,date:"2020-01-01",note:""}),this.$forceUpdate()},deletePresentation:function(t){var e=this;confirm("Вы действительно хотите удалить предъявление от "+new Date(this.data.notes[t].date).toLocaleDateString()+"?\r\nЭто действие невозможно отменить после выполнения.\r\n\r\nСодержание предъявления:\r\n"+this.data.notes[t].note)&&(-1!=this.data.notes[t].id?o()({method:"delete",url:l.host+"/api/presentations/"+this.data.notes[t].id,headers:{Authorization:this.AuthStr}}).catch((function(a){"true"==a.response.data.error.messages[0]?(e.deleted.push(e.data.notes[t].id),e.data.notes.splice(t,1),e.$forceUpdate()):alert("Не удалось удалить предъявление.")})):(this.data.notes.splice(t,1),this.$forceUpdate()))},saveAndClose:function(){var t,e=this,a=!0;switch(this.model){case"mooringCertificates":t="mooring_certificates";break;case"travelingCertificates":t="traveling_certificates";break;case"reports":t="reports";break}if(this.data.notes.forEach((function(n){-1!=n.id?o.a.put(l.host+"/api/presentations/"+n.id,{model_id:e.id,model_type:t,date:JSON.stringify(n.date),note:JSON.stringify(n.note)},{headers:{Authorization:e.AuthStr}}).catch((function(){return a=!1})):o.a.post(l.host+"/api/presentations/",{model_id:e.id,model_type:t,date:JSON.stringify(n.date),note:JSON.stringify(n.note)},{headers:{Authorization:e.AuthStr}}).then((function(t){return n.id=t.data.data.id})).catch((function(){return a=!1}))})),a){var n=[];this.data.notes.forEach((function(t){n.push({date:t.date,note:t.note.replace(/\n/g,"<br />")})})),this.callback(n),this.close()}else alert("Произошла ошибка\r\n\r\nПри сохранении не удалось записать часть данных.\r\nПожалуйста, проверьте введённые данные или повторите попытку позже.")}}},Gt=Ut,Wt=(a("7650"),Object(f["a"])(Gt,Bt,Ft,!1,null,null,null)),Mt=Wt.exports;n["a"].component("scroll-bar",z.a),n["a"].component("presentation-form",Mt);var Yt={props:["pages","currentPage"],data:function(){return{current:0,canImport:!1,role:0,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{buttonClick:function(t,e){this.canImport=t>1,this.current=t,Za.push(e||"")},importExcel:function(){var t=this,e=new FormData,a=this.$refs.inputDialog;a.onchange=function(){if(void 0!=a.files[0]){var n;switch(e.append("file",a.files[0]),t.current){case 2:n="construction";break;case 3:n="mooring";break;case 4:n="traveling";break}e.append("type",n),o.a.post(l.host+"/api/objects/"+t.$router.history.current.params.idObject+"/import",e,{headers:{Authorization:t.AuthStr}}).then((function(){return a.value=""})).catch((function(t){"Ожидайте."==t.response.data.error.messages[0]?alert("Файл был успешно загружен на сервер.\r\rВ данный момент он обрабатывается.\rЭто может занять несколько минут."):alert("При загрузке файла произошла ошибка."),a.value=""}))}},a.click()},exportExcel:function(){var t;switch(this.current){case 2:t="construction";break;case 3:t="mooring";break;case 4:t="traveling";break}o()({method:"get",url:l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/export?type="+t,headers:{Authorization:this.AuthStr}}).then((function(t){window.open(l.host+"/storage/"+t.data.data.name+"."+t.data.data.extension,"_blank")})).catch((function(t){console.log(t)}))},presentation:function(t,e){this.$refs.presentation.isActive=!0,this.$refs.presentation.id=t.id,this.$refs.presentation.model=t.model,this.$refs.presentation.callback=e,this.$refs.presentation.loadData()}},created:function(){this.role=sessionStorage.getItem("role"),this.current=this.$props.currentPage?this.$props.currentPage:0,this.buttonClick(this.current)},updated:function(){var t=this;this.pages.find((function(e,a){t.$route.path==e.path&&(t.current=a,t.buttonClick(t.current))}))}},Ht=Yt,Jt=(a("6fe9"),Object(f["a"])(Ht,Rt,Nt,!1,null,null,null)),Qt=Jt.exports;n["a"].component("breadcrumbs",$),n["a"].component("scroll",z.a),n["a"].component("tables-view",Qt);var qt={data:function(){return{breadCrumbs:[{name:"Объекты",link:"/watcher/objects/"}]}},methods:{goToMain:function(){this.breadCrumbs=[{name:"Объекты",link:"/watcher/objects/"}]},update:function(t){switch(t.type){case"openObject":this.breadCrumbs.push({name:t.value,link:t.link});break}}},created:function(){-1==window.location.pathname.indexOf("objects")&&Za.push("/watcher/objects/")},updated:function(){-1==window.location.pathname.indexOf("objects")&&Za.push("/watcher/objects/"),"/watcher/objects/"==this.$route.path&this.breadCrumbs.length>1&&(this.breadCrumbs=[{name:"Объекты",link:"/watcher/objects/"}])}},Kt=qt,Xt=Object(f["a"])(Kt,Lt,zt,!1,null,null,null),Vt=Xt.exports,Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table-view",{ref:"table",staticClass:"watcher-table",attrs:{headers:t.infoHeaders,data:t.data},on:{rowClick:t.rowClick,addRow:t.add,update:t.update}})},te=[];n["a"].component("scroll",z.a),n["a"].component("tables-view",rt);var ee={data:function(){return{breadCrumbs:["Объекты"],infoHeaders:["Наименование объекта по ГК","Строительный номер","Название","Порт поставки","Порт регистрации","Стоимость (₽)","Примечание"],data:[],lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{rowClick:function(t){var e;this.data.forEach((function(a){a.id==t&&(e=a.data.name.value)})),this.$emit("update",{type:"openObject",value:e,link:"/watcher/objects/"+t+"/UP"}),this.$router.push("/watcher/objects/"+t+"/UP")},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/objects","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id,t.data.push({id:e.data.data.id,data:{nameSC:{value:"",type:"text"},number:{value:"",type:"text"},name:{value:"",type:"text"},deliveryPort:{value:"",type:"text"},registrationPort:{value:"",type:"text"},cost:{value:"",type:"number"},note:{value:"",type:"text"}}})}))},update:function(){null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit,this.lastAddedId=null)},edit:function(t,e){var a=this;o.a.put(l.host+"/api/objects/"+e,"contract_name="+t[0]+"&building_number="+t[1]+"&name="+t[2]+"&delivery_port="+t[3]+"&registration_port="+t[4]+"&price="+t[5]+"&note="+t[6],{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(a){a.id==e&&(a.data.nameSC.value=t.data.data.contract_name,a.data.number.value=t.data.data.building_number,a.data.name.value=t.data.data.name,a.data.deliveryPort.value=t.data.data.delivery_port,a.data.registrationPort.value=t.data.data.registration_port,a.data.cost.value=t.data.data.price?parseFloat(t.data.data.price).toLocaleString():"",a.data.note.value=t.data.data.note)}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить этот объект?")&&o.a.delete(l.host+"/api/objects/"+t,{headers:{Authorization:this.AuthStr}}).then((function(){for(var a=0;a<e.data.length;a++)if(e.data[a].id==t)return void e.data.splice(a,1)})).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=0;n<e.data.length;n++)if(e.data[n].id==t)return void e.data.splice(n,1);alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))}},created:function(){var t=this;o.a.get(l.host+"/api/objects",{headers:{Authorization:this.AuthStr}}).then((function(e){var a=[];e.data.data.forEach((function(t){var e={};e.id=t.id,e.data={},e.data.nameSC={},e.data.nameSC.value=t.contract_name,e.data.nameSC.type="text",e.data.number={},e.data.number.value=t.building_number,e.data.number.type="text",e.data.name={},e.data.name.value=t.name,e.data.name.type="text",e.data.deliveryPort={},e.data.deliveryPort.value=t.delivery_port,e.data.deliveryPort.type="text",e.data.registrationPort={},e.data.registrationPort.value=t.registration_port,e.data.registrationPort.type="text",e.data.cost={},e.data.cost.value=t.price?parseFloat(t.price).toLocaleString():"",e.data.cost.type="number",e.data.note={},e.data.note.value=t.note,e.data.note.type="text",a.push(e)})),t.data=a}))}},ae=ee,ne=(a("c5e7"),Object(f["a"])(ae,Zt,te,!1,null,null,null)),ie=ne.exports,de=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"watcher-block"},[a("tables-view",{attrs:{pages:t.pages,currentPage:this.current}})],1)},re=[],se={data:function(){return{pages:[{text:"Закрытие УП",path:"/watcher/objects/"+this.$router.history.current.params.idObject+"/UP"},{text:"Закрытие УШ",path:"/watcher/objects/"+this.$router.history.current.params.idObject+"/USh"},{text:"Закрытие УХ",path:"/watcher/objects/"+this.$router.history.current.params.idObject+"/UH"}],current:0,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},mounted:function(){var t=this;this.$parent.$children[0].data.length<=1&&o.a.get(l.host+"/api/objects/"+this.$router.currentRoute.params.idObject,{headers:{Authorization:this.AuthStr}}).then((function(e){t.$emit("update",{type:"openObject",value:e.data.data.name,link:"/watcher/objects/"+t.$router.currentRoute.params.idObject+"/UP"})}))},created:function(){var t=this.$router.currentRoute.path;t.indexOf("/UP")>=0&&(this.current=0),t.indexOf("/USh")>=0&&(this.current=1),t.indexOf("/UH")>=0&&(this.current=2)}},oe=se,le=(a("2fc0"),Object(f["a"])(oe,de,re,!1,null,null,null)),ue=le.exports,ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row",on:{click:t.add}},[t._v("Добавить новую характеристику")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{headers:t.headers,data:t.data},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)])},he=[];n["a"].component("table-view",rt);var pe={data:function(){return{headers:["Наименование","Значение"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/shipProperties","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{name:{value:"",type:"text"},value:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n="",i=["key","value"];t.forEach((function(t,e){""!=t&null!=t&void 0!=t&&(n+="&"+i[e]+"="+t)})),o.a.put(l.host+"/api/shipProperties/"+e,n.substring(1),{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){n.id==e&&(n.data.name.value=t.data.data.key,n.data.value.value=t.data.data.value,a.lastAddedId=null)}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить данную запись?")&&o()({method:"delete",url:l.host+"/api/shipProperties/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.ship_properties.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}],e.data={},e.data.name={},e.data.name.value=t.key,e.data.name.type="text",e.data.value={},e.data.value.value=t.value,e.data.value.type="text",a.push(e)})),i.data.data.ship_properties.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/shipProperties",1)}},fe=pe,ve=Object(f["a"])(fe,ce,he,!1,null,null,null),me=ve.exports,be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row",on:{click:function(e){return t.add()}}},[t._v("Добавить новую гарантию")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{headers:t.headers,data:t.data},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)])},ge=[];n["a"].component("table-view",rt);var _e={data:function(){return{headers:["Сумма","Дата","Номер","Срок действия","Кто выдал","Дата последнего изменения","Примечание"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/bankGuarantees/","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{amount:{value:"",type:"number"},date:{value:"",type:"date"},number:{value:"",type:"text"},validity:{value:"",type:"date"},issuedBy:{value:"",type:"text"},last:{value:"",type:"date"},note:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n=["amount","date","number","validity","issued_by","last_modified_date","note"],i={};t.forEach((function(t,e){null!=t&""!=t&void 0!=t|1==e|3==e|5==e&&(i[n[e]]=t)})),o.a.put(l.host+"/api/bankGuarantees/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){var i=null!=t.data.data.date?new Date(t.data.data.date).toLocaleDateString():"",d=null!=t.data.data.validity?new Date(t.data.data.validity).toLocaleDateString():"",r=null!=t.data.data.last_modified_date?new Date(t.data.data.last_modified_date).toLocaleDateString():"";n.data.amount.value=t.data.data.amount,n.data.date.value=i,n.data.number.value=t.data.data.number,n.data.validity.value=d,n.data.issuedBy.value=t.data.data.issued_by,n.data.last.value=r,n.data.note.value=t.data.data.note,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o.a.delete(l.host+"/api/bankGuarantees/"+t,{headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o.a.get(t+"?page="+e,{headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.bank_guarantees.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}];var i=null!=t.date?new Date(t.date).toLocaleDateString():"",d=null!=t.validity?new Date(t.validity).toLocaleDateString():"",r=null!=t.last_modified_date?new Date(t.last_modified_date).toLocaleDateString():"";e.data={},e.data.amount={},e.data.amount.value=t.amount?parseFloat(t.amount).toLocaleString():"",e.data.amount.type="number",e.data.date={},e.data.date.value=i,e.data.date.type="date",e.data.number={},e.data.number.value=t.number,e.data.number.type="text",e.data.validity={},e.data.validity.value=d,e.data.validity.type="date",e.data.issuedBy={},e.data.issuedBy.value=t.issued_by,e.data.issuedBy.type="text",e.data.last={},e.data.last.value=r,e.data.last.type="date",e.data.note={},e.data.note.value=t.note,e.data.note.type="text",a.push(e)})),i.data.data.bank_guarantees.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/bankGuarantees",1)}},ye=_e,we=Object(f["a"])(ye,be,ge,!1,null,null,null),xe=we.exports,Ae=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row",on:{click:function(e){return t.addLimit()}}},[t._v("Добавить новый лимит")])]),a("scroll-bar",{staticClass:"table-wrapper"},[a("header",{staticClass:"table-view_headers limit-header",staticStyle:{display:"inline-grid","min-width":"100%"}},[a("div",{style:this.years.length>0?"display: grid;grid-template-columns: repeat("+this.years.length+", minmax(200px, 1fr))":""},t._l(this.years,(function(e,n){return a("span",{key:n,staticClass:"table-view_header no-sort"},[t._v(" "+t._s(e.value)+" "),a("more-tools",{staticClass:"header-more-tools",attrs:{options:e.options,id:e.id},on:{"option-click":t.yearOption}})],1)})),0),a("button",{staticClass:"addColumn",staticStyle:{position:"relative"},attrs:{title:"Добавить новый год"},on:{click:t.addYear}}),a("span",{staticClass:"table-view_header no-sort"},[t._v("Примечание")])]),a("div",{staticClass:"table-view_body"},t._l(this.data,(function(e,n){return a("div",{key:n},[0==e.isEdit?a("div",{staticClass:"table-view_row",style:e.years.length>0?"min-width: 100%;border-bottom: 1px solid #dcdce8;display: inline-grid;grid-template-columns: repeat("+e.years.length+", minmax(200px, 1fr)) 60px 500px":""},[t._l(e.years,(function(e,n){return a("span",{key:n,staticClass:"table-view_cell"},[t._v(" "+t._s(""!=e.value?parseFloat(e.value).toLocaleString():"")+" ")])})),a("span"),a("span",{staticClass:"table-view_cell",staticStyle:{"padding-right":"90px"}},[t._v(t._s(e.note))]),a("more-tools",{staticStyle:{"margin-right":"20px"},attrs:{options:e.options,id:e.years},on:{"option-click":t.limitOption}})],2):t._e(),1==e.isEdit?a("div",{staticClass:"table-view_row",style:e.years.length>0?"min-width: 100%;border-bottom: 1px solid #dcdce8;display: inline-grid;grid-template-columns: repeat("+e.years.length+", minmax(200px, 1fr)) 60px 500px":""},[t._l(e.years,(function(t,e){return a("input",{key:e,ref:"editInputs",refInFor:!0,staticClass:"table-view_cell",attrs:{"cell-id":t.id,type:"number"},domProps:{value:t.value}})})),a("span"),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.note,expression:"row.note"}],ref:"editInputs",refInFor:!0,staticClass:"table-view_cell-textarea",domProps:{value:e.note},on:{input:function(a){a.target.composing||t.$set(e,"note",a.target.value)}}}),a("div",{staticClass:"more-tools save-btn",attrs:{title:"Сохранить изменения"},on:{click:function(e){return t.editLimit(1)}}})],2):t._e()])})),0)]),a("div",{class:"modal-wrapper "+[t.modalWindowIsShow?" modal-wrapper__active":""]},[a("div",{staticClass:"modal-dark-background"}),a("div",{staticClass:"modal-window modal-window-limits"},[a("header",{staticClass:"modal-window_header"},[t._v("Укажите год для лимита "),a("button",{staticClass:"modal-window_close",on:{click:t.close}})]),a("div",{staticClass:"limit-year-form"},[a("input",{ref:"yearInput",staticClass:"table-view_cell add-limit-year_input",attrs:{type:"number"}}),a("button",{staticClass:"add-row add-limit-year_button",on:{click:function(e){t.modalEvent&&t.modalEvent()}}},[t._v("ОК")])])])])],1)},Se=[],De=(a("498a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-view-wrapper"},[a("scroll-bar",{staticClass:"table-view",attrs:{settings:{suppressScrollY:!0}}},[void 0!=this.data?a("header",{staticClass:"table-view_headers",style:"grid-template-columns: "+[this.headers.length>2?"repeat("+(this.headers.length-2)+", minmax(300px, 1fr))":""]+" 40px 500px 40px;"},t._l(this.headers,(function(e,n){return a("div",{key:n,ref:"header",refInFor:!0,staticClass:"table-view_header no-sort"},["addButton"!=e.value&"Примечание"!=e.value&0==e.isEdit?a("span",[t._v(" "+t._s(e.value)+" "),a("more-tools",{attrs:{options:e.options,id:e.id},on:{"option-click":t.yearOption}})],1):t._e(),"addButton"!=e.value&"Примечание"!=e.value&1==e.isEdit?a("input",{ref:"currentYear",refInFor:!0,staticClass:"table-view_cell",attrs:{type:"number"},domProps:{value:e.value},on:{keyup:function(a){return t.yearUpdate(e.id,a)}}}):t._e(),"addButton"==e.value?a("button",{staticClass:"addColumn",attrs:{title:"Добавить новый год"},on:{click:t.addColumn}}):t._e(),"Примечание"==e.value?a("span",[t._v(t._s(e.value))]):t._e()])})),0):t._e(),void 0!=this.data?a("scroll-bar",{class:"table-view_body"+[this.firstColumn?" table-view_body__first-column":""],attrs:{settings:{wheelPropagation:!0,suppressScrollX:!0}}},t._l(this.data,(function(e,n){return a("div",{key:n,staticClass:"table-view_row"},[a("row-view",{ref:e.id,refInFor:!0,attrs:{index:n,rowData:e,inRowAdd:t.inRowAdd,columnsWidth:"grid-template-columns: repeat("+[void 0!=e.data?Object.keys(e.data).length-2:0]+", minmax(300px, 1fr)) 40px 500px 40px;"},on:{addRow:t.addRow}})],1)})),0):t._e(),void 0==this.data?a("div",{staticClass:"new-row-button-wrapper"},[1==this.inRowAdd?a("button",{staticClass:"new-row-button",on:{click:function(e){return t.addRow()}}},[t._v("Добавить новую запись")]):t._e(),1!=this.inRowAdd?a("p",[t._v("Нет записей")]):t._e()]):t._e(),0==this.data.length?a("div",{staticClass:"new-row-button-wrapper"},[1==this.inRowAdd&0==this.data.length?a("button",{staticClass:"new-row-button",on:{click:function(e){return t.addRow()}}},[t._v("Добавить новую запись")]):t._e(),1!=this.inRowAdd&0==this.data.length?a("p",[t._v("Нет записей")]):t._e()]):t._e()],1)],1)}),ke=[];n["a"].component("scroll-bar",z.a),n["a"].component("row-view",K),n["a"].component("more-tools",at);var Ie={props:["data","headers","firstColumn","inRowAdd"],data:function(){return{rowsCount:0}},methods:{yearOption:function(t){this.$emit("yearOption",t)},addRow:function(t){this.$emit("addRow",t)},addColumn:function(){this.$emit("addColumn")},yearUpdate:function(t,e){"Enter"==e.code&&this.$emit("yearUpdate",t)}},created:function(){void 0!=this.data?this.rowsCount=this.data.length:this.rowsCount=0},updated:function(){this.rowsCount<this.data.length&&this.$emit("update")}},$e=Ie,Ce=(a("cd6e"),Object(f["a"])($e,De,ke,!1,null,null,null)),Ee=Ce.exports;n["a"].component("scroll-bar",z.a),n["a"].component("limit-view",Ee);var je={data:function(){return{modalWindowIsShow:!1,modalEvent:null,editYearId:null,editLimitId:null,isEdit:!1,years:[],data:[],AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{close:function(){this.modalWindowIsShow=!1,this.$refs.yearInput.value="",this.modalEvent=null},addYear:function(){var t=this;this.isEdit?alert("Пожалуйста, закончите редактирование таблицы и повторите попытку."):(this.modalWindowIsShow=!0,this.modalEvent=function(){if(""!=t.$refs.yearInput.value){var e=!1;if(t.years.find((function(a){a.value==t.$refs.yearInput.value&&(e=!0)})),e)return void alert(t.$refs.yearInput.value+" год уже записан в лимиты.");var a=t.$refs.yearInput.value,n={data:[]};return t.data.forEach((function(e){n.data.push({contract_id:t.$router.history.current.params.id,note:e.note,price:"x",years:a})})),void o()({method:"post",data:n,url:l.host+"/api/limitBudgetaryObligations/multiple",headers:{Authorization:t.AuthStr}}).then((function(e){t.years.push({id:t.years.length,value:a,options:[{id:"edit",text:"Редактировать",event:t.editYear},{id:"delet",text:"Удалить",event:t.deletYear}]}),e.data.data.forEach((function(e,n){t.data[n].years.push({id:e.id,year:a,value:""})})),t.modalWindowIsShow=!1,t.$refs.yearInput.value=""}))}alert("Поле не заполнено.\r\rПожалуйста, заполните поле и повторите попытку")})},editYear:function(){var t=this;if(""!=this.$refs.yearInput.value){var e=!1;if(this.years.find((function(a){a.value==t.$refs.yearInput.value&&(e=!0)})),e)return void alert(this.$refs.yearInput.value+" год уже записан в лимиты.");var a=this.$refs.yearInput.value,n={data:[]};return this.data.forEach((function(e){n.data.push({id:e.years[t.editYearId].id,years:a})})),void(this.data.length>0?o()({method:"put",data:n,url:l.host+"/api/limitBudgetaryObligations/multiple",headers:{Authorization:this.AuthStr}}).then((function(){t.years[t.editYearId].value=a,t.data.forEach((function(e){e.years[t.editYearId].year=a})),t.modalWindowIsShow=!1,t.$refs.yearInput.value=""})):(this.years[this.editYearId].value=a,this.modalWindowIsShow=!1,this.$refs.yearInput.value=""))}alert("Поле не заполнено.\r\rПожалуйста, заполните поле и повторите попытку")},deletYear:function(t){var e=this;if(this.isEdit)alert("Пожалуйста, закончите редактирование таблицы и повторите попытку.");else if(confirm("Вы действительно хотите удалить "+this.years[t].value+" год?")){var a={data:[]};this.data.forEach((function(e){a.data.push({id:e.years[t].id})})),this.data.length>0?o()({method:"delete",data:a,url:l.host+"/api/limitBudgetaryObligations/multiple",headers:{Authorization:this.AuthStr}}).catch((function(a){"true"==a.response.data.error.messages[0]&&(e.years.splice(t,1),0==e.years.length?e.data=[]:e.data.forEach((function(e){e.years.splice(t,1)})),e.years.forEach((function(t,e){t.id=e})))})):(this.years.splice(t,1),this.years.forEach((function(t,e){t.id=e})))}},yearOption:function(t){switch(t.data.id){case"edit":this.isEdit?alert("Пожалуйста, закончите редактирование таблицы и повторите попытку."):(this.editYearId=t.id,this.$refs.yearInput.value=this.years[t.id].value,this.modalWindowIsShow=!0,this.modalEvent=t.data.event);break;case"delet":t.data.event(t.id);break}},addLimit:function(){var t=this;if(this.isEdit)alert("В данный момент вы редактируете таблицу.\rЧтобы добавить новый лимит, необходимо звершить редактирование.");else if(this.years.length>0){this.isEdit=!0;var e=0;this.data.forEach((function(t){if(t.note.indexOf("Примечание №")>-1){var a=parseInt(t.note.substring(12)+"jbhmn");"number"==typeof a&&a>e&&(e=a)}}));var a={data:[]};this.years.forEach((function(n){a.data.push({contract_id:t.$router.history.current.params.id,note:"Примечание №"+(e+1),price:"x",years:n.value})})),o()({method:"post",data:a,url:l.host+"/api/limitBudgetaryObligations/multiple",headers:{Authorization:this.AuthStr}}).then((function(e){var a={note:e.data.data[0].note,years:[],isEdit:!0,options:[{id:"edit",text:"Редактировать",event:t.editLimit},{id:"delet",text:"Удалить",event:t.deletLimit}]};e.data.data.forEach((function(t){var e={id:t.id,year:t.years,value:"x"!=t.price?t.price:""};a.years.push(e)})),t.data.push(a),t.editLimitId=t.data.length-1,t.editLimit()}))}else alert("Для добавления нового лимита, необходимо добавить хотябы один год.")},editLimit:function(t){var e=this;setTimeout((function(){var a=e.$refs.editInputs;function n(t){if(""!=a[a.length-1].value.replace(/\r?\n/g,"").trim()){var e=!0;if(t.data.forEach((function(n,i){n.note==a[a.length-1].value&i!=t.editLimitId&&(e=!1)})),e){var n={data:[]};t.data[t.editLimitId].years.forEach((function(t,e){n.data.push({id:t.id,note:a[a.length-1].value,price:""==a[e].value?"x":a[e].value})})),o()({method:"put",data:n,url:l.host+"/api/limitBudgetaryObligations/multiple",headers:{Authorization:t.AuthStr}}).then((function(){t.data[t.editLimitId].years.forEach((function(t,e){t.value=a[e].value})),t.data[t.editLimitId].note=a[a.length-1].value,t.data[t.editLimitId].isEdit=!1,t.isEdit=!1,t.editLimitId=!1}))}else alert("Лимит с таким примечанием уже существует.\rПерепроверьте введённые данные и повторите попытку.")}else alert('Необходимо заполнить поле "Примечание"'),a[a.length-1].value=null}t?n(e):a.forEach((function(t){t.onkeydown=function(t){13==t.keyCode&&n(e)}}))}),10)},deletLimit:function(t){var e=this;this.isEdit?alert("Пожалуйста, закончите редактирование таблицы и повторите попытку."):this.data.find((function(a,n){if(a.years[0].id==t[0].id&&confirm("Вы действительно хотите удалить этот лимит?\r\rПримечание лимита:\r"+a.note)){var i={data:[]};e.data[n].years.forEach((function(t){i.data.push({id:t.id})})),o()({method:"delete",data:i,url:l.host+"/api/limitBudgetaryObligations/multiple",headers:{Authorization:e.AuthStr}}).catch((function(t){"true"==t.response.data.error.messages[0]&&e.data.splice(n,1)}))}}))},limitOption:function(t){var e=this;switch(t.data.id){case"edit":this.isEdit?alert("Пожалуйста, закончите редактирование таблицы и повторите попытку."):this.data.find((function(a,n){a.years[0].id==t.id[0].id&&(e.isEdit=!0,a.isEdit=!0,e.editLimitId=n,e.editLimit())}));break;case"delet":t.data.event(t.id);break}},loadData:function(t){var e=this,a=[],n=[];Object.keys(t.data).forEach((function(i,d){var r={created_at:t.data[i].created_at,note:i,years:[],isEdit:!1,options:[{id:"edit",text:"Редактировать",event:e.editLimit},{id:"delet",text:"Удалить",event:e.deletLimit}]};Object.keys(t.data[i]).forEach((function(n,s){if("created_at"!=n){var o=t.data[i][n],l=Object.keys(o)[0],u={id:n,year:l,value:"x"!=o[l]?o[l]:""};r.years.push(u),0==d&&a.push({id:s,value:l,options:[{id:"edit",text:"Редактировать",event:e.editYear},{id:"delet",text:"Удалить",event:e.deletYear}]})}})),n.push(r)})),n.sort((function(t,e){return t.created_at>e.created_at?1:t.created_at<e.created_at?-1:t.created_at==e.created_at?0:void 0})),this.data=n,this.years=a}},created:function(){var t=this;this.isEdit=!1,o()({method:"get",url:l.host+"/api/contracts/"+this.$router.history.current.params.id+"/limitBudgetaryObligations",headers:{Authorization:this.AuthStr}}).then((function(e){t.loadData(e)}))}},Te=je,Oe=(a("c2d7"),Object(f["a"])(Te,Ae,Se,!1,null,null,null)),Pe=Oe.exports,Le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row",on:{click:t.add}},[t._v("Добавить новый объект")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{headers:t.infoHeaders,data:t.data},on:{sort:t.sort,rowClick:t.rowClick,addRow:t.add,update:t.update}})],1)])},ze=[];n["a"].component("scroll",z.a),n["a"].component("tables-view",Qt);var Re={data:function(){return{infoHeaders:["Наименование объекта по ГК","Строительный номер","Название","Порт поставки","Порт регистрации","Стоимость (₽)","Примечание"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},rowClick:function(t){this.$router.push("/deal/"+this.$router.history.current.params.id+"/objects/"+t+"/about")},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/objects","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id,t.data.push({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{nameSC:{value:"",type:"text"},number:{value:"",type:"text"},name:{value:"",type:"text"},deliveryPort:{value:"",type:"text"},registrationPort:{value:"",type:"text"},cost:{value:"",type:"number"},note:{value:"",type:"text"}}})}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit,this.lastAddedId=null)},edit:function(t,e){var a=this,n=["contract_name","building_number","name","delivery_port","registration_port","price","note"],i="";t.forEach((function(t,e){null!=t&""!=t&void 0!=t&&(i+="&"+n[e]+"="+t)})),o.a.put(l.host+"/api/objects/"+e,i.substring(1),{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(a){a.id==e&&(a.data.nameSC.value=t.data.data.contract_name,a.data.number.value=t.data.data.building_number,a.data.name.value=t.data.data.name,a.data.deliveryPort.value=t.data.data.delivery_port,a.data.registrationPort.value=t.data.data.registration_port,a.data.cost.value=null!=t.data.data.price?parseFloat(t.data.data.price).toLocaleString():"",a.data.note.value=t.data.data.note)}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить этот объект?")&&o.a.delete(l.host+"/api/objects/"+t,{headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o.a.get(t+"?page="+e,{headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.contract_objects.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}],e.data={},e.data.nameSC={},e.data.nameSC.value=t.contract_name,e.data.nameSC.type="text",e.data.number={},e.data.number.value=t.building_number,e.data.number.type="text",e.data.name={},e.data.name.value=t.name,e.data.name.type="text",e.data.deliveryPort={},e.data.deliveryPort.value=t.delivery_port,e.data.deliveryPort.type="text",e.data.registrationPort={},e.data.registrationPort.value=t.registration_port,e.data.registrationPort.type="text",e.data.cost={},e.data.cost.value=null!=t.price?parseFloat(t.price).toLocaleString():"",e.data.cost.type="number",e.data.note={},e.data.note.value=t.note,e.data.note.type="text",a.push(e)})),i.data.data.contract_objects.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/contractObjects",1)}},Ne=Re,Be=Object(f["a"])(Ne,Le,ze,!1,null,null,null),Fe=Be.exports,Ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tables-view",{attrs:{pages:t.pages,currentPage:this.current}})},Ge=[],We={data:function(){return{pages:[{text:"Об объекте",path:"/deal/"+this.$router.history.current.params.id+"/objects/"+this.$router.history.current.params.idObject+"/about"},{text:"Наблюдатели",path:"/deal/"+this.$router.history.current.params.id+"/objects/"+this.$router.history.current.params.idObject+"/watchers"},{text:"Закрытие УП",path:"/deal/"+this.$router.history.current.params.id+"/objects/"+this.$router.history.current.params.idObject+"/UP"},{text:"Закрытие УШ",path:"/deal/"+this.$router.history.current.params.id+"/objects/"+this.$router.history.current.params.idObject+"/USh"},{text:"Закрытие УХ",path:"/deal/"+this.$router.history.current.params.id+"/objects/"+this.$router.history.current.params.idObject+"/UH"}],current:0}},created:function(){var t=this.$router.currentRoute.path;t.indexOf("/about")>=0&&(this.current=0),t.indexOf("/watchers")>=0&&(this.current=1),t.indexOf("/UP")>=0&&(this.current=2),t.indexOf("/USh")>=0&&(this.current=3),t.indexOf("/UH")>=0&&(this.current=4)}},Me=We,Ye=Object(f["a"])(Me,Ue,Ge,!1,null,null,null),He=Ye.exports,Je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row",on:{click:t.add}},[t._v("Добавить новую характеристику")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{headers:t.headers,data:t.data},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)])},Qe=[];n["a"].component("table-view",rt);var qe={data:function(){return{headers:["Наименование","Значение"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/aboutObjects/","contract_object_id="+this.$router.history.current.params.idObject,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{name:{value:"",type:"text"},value:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n="",i=["name","value"];t.forEach((function(t,e){""!=t&null!=t&void 0!=t&&(n+="&"+i[e]+"="+t)})),o.a.put(l.host+"/api/aboutObjects/"+e,n.substring(1),{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(a){a.id==e&&(a.data.name.value=t.data.data.name,a.data.value.value=t.data.data.value)})),a.lastAddedId=null})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o()({method:"delete",url:l.host+"/api/aboutObjects/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.about_objects.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}],e.data={},e.data.name={},e.data.name.value=t.name,e.data.name.type="text",e.data.value={},e.data.value.value=t.value,e.data.value.type="text",a.push(e)})),i.data.data.about_objects.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/aboutObjects",1)}},Ke=qe,Xe=Object(f["a"])(Ke,Je,Qe,!1,null,null,null),Ve=Xe.exports,Ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table-view",{ref:"table",attrs:{headers:t.headers,data:t.data},on:{checkboxChange:t.userSelect,addRow:t.add,update:t.update}})},ta=[];n["a"].component("table-view",rt);var ea={data:function(){return{headers:["","Фамилия Имя","Примечание"],data:[],lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{userSelect:function(){var t="",e=0;this.data.forEach((function(a){1==a.data.isWatcher.value&&(t+="&users_ids["+e+"]="+a.id),e++})),o.a.put(l.host+"/api/objects/"+this.$router.history.current.params.idObject,t.substring(1),{headers:{Authorization:this.AuthStr}}).then((function(t){console.log(t)}))},add:function(){var t=this;o.a.post(l.host+"/api/travelingCertificates","contract_object_id="+this.$router.history.current.params.idObject,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id,t.data.push({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{namber:{value:"",type:"text"},name:{value:"",type:"text"},documentation:{value:"",type:"text"},date:{value:"",type:"date"},note:{value:"",type:"text"},plannedDate:{value:"",type:"date"},realDate:{value:"",type:"date"},files:{value:"",type:"file"}}})}))},update:function(){null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit,this.lastAddedId=null)},edit:function(t,e){var a=this;o.a.put(l.host+"/api/travelingCertificates/"+e,"number="+t[0]+"&name="+t[1]+"&documentation="+t[2]+"&date="+t[3]+"&note="+t[4]+"&closing_date_planned="+t[5]+"&closing_date_real="+t[6]+"&files=0",{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(a){if(a.id==e){var n="",i=null!=t.data.data.closing_date_planned?new Date(t.data.data.closing_date_planned).toLocaleDateString():"",d=null!=t.data.data.closing_date_real?new Date(t.data.data.closing_date_real).toLocaleDateString():"";a.data.namber.value=t.data.data.number,a.data.name.value=t.data.data.name,a.data.documentation.value="",a.data.date.value=n,a.data.note.value="",a.data.plannedDate.value=i,a.data.realDate.value=d,a.data.files.value=""}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;o.a.delete(l.host+"/api/travelingCertificates/"+t,{headers:{Authorization:this.AuthStr}}).then((function(){for(var a=0;a<e.data.length;a++)if(e.data[a].id==t)return void e.data.splice(a,1)})).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=0;n<e.data.length;n++)if(e.data[n].id==t)return void e.data.splice(n,1);alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t){var e=this;t=void 0==t?l.host+"/api/contracts":t,o.a.get(t,{headers:{Authorization:this.AuthStr}}).then((function(t){var a=t.data.data;o.a.get(l.host+"/api/objects/"+e.$router.history.current.params.idObject,{headers:{Authorization:e.AuthStr}}).then((function(t){a.forEach((function(a){if(0==a.role){var n={};n.id=a.id,n.data={},n.data.isWatcher={},n.data.isWatcher.value=!1,n.data.isWatcher.type="checkbox";for(var i=0;i<t.data.data.users.length;i++)t.data.data.users[i].id==a.id&&(n.data.isWatcher.value=!0);n.data.name={},n.data.name.value=a.fullname,n.data.name.type="text",n.data.note={},n.data.note.value=a.company,n.data.note.type="text",e.data.push(n)}}))})),null!=t.data.links.next&&e.loadData(t.data.links.next)}))}},created:function(){this.loadData(l.host+"/api/users")}},aa=ea,na=Object(f["a"])(aa,Ze,ta,!1,null,null,null),ia=na.exports,da=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[1==this.role?a("button",{staticClass:"add-row",on:{click:t.addGroupQuery}},[t._v("Добавить новую группу УП")]):t._e(),a("scroll-bar",{staticStyle:{"max-height":"50vh"}},t._l(t.data,(function(e,n){return a("div",{key:n,staticClass:"group-wrapper"},[a("div",{staticClass:"group-header",on:{click:function(e){return t.loadUP(n,"group-checker"+n,"",1)}}},[e.isEdit?t._e():a("label",{staticClass:"group-name",attrs:{for:"group-checker"+n}},[t._v(" "+t._s(e.name)+" ")]),e.isEdit?a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"group.name"}],ref:"group-name-input-"+n,refInFor:!0,staticClass:"group-name group-name__edit",attrs:{type:"text"},domProps:{value:e.name},on:{input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}}):t._e(),e.options.length>0?a("more-tools",{attrs:{options:e.options,id:e.id,customStyle:"display: flex; flex-direction: row;"},on:{"option-click":t.groupTools}}):t._e()],1),a("input",{ref:"group-checker"+n,refInFor:!0,staticClass:"group-checker",attrs:{id:"group-checker"+n,type:"checkbox"}}),a("div",{staticClass:"group-content"},[a("table-view",{ref:"table"+e.id,refInFor:!0,attrs:{headers:e.subTable.headers,data:e.subTable.rows,inRowAdd:!0,subTableColumns:"grid-template-columns: repeat(3, minmax(300px, 1fr)) 500px repeat(2, minmax(300px, 1fr)) 40px;"},on:{addRow:function(a){return t.add(e.id)},addRowInSubTable:t.addRaport,update:t.update,sort:t.sort}})],1)])})),0)],1)},ra=[];n["a"].component("scroll-bar",z.a),n["a"].component("more-tools",at),n["a"].component("table-view",rt);var sa={data:function(){return{data:[],groupPreloader:[],groupEditId:null,role:0,lastAddedId:null,lastAddedReportId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data.find((function(a,n){0!=a.subTable.rows.length&&(e.data[n].subTable.rows=[],e.$nextTick().then((function(){e.data[n].subTable.rows=t})))}))},addGroupQuery:function(){var t=this;null==this.groupEditId&&o()({method:"post",url:l.host+"/api/groups",data:"contract_object_id="+this.$router.history.current.params.idObject,headers:{Authorization:this.AuthStr}}).then((function(e){t.addGroup(e.data.data,!0)}))},groupTools:function(t){var e=this;"edit"==t.data.id?this.data.find((function(a){a.id==t.id&&(a.isEdit=!0,e.groupEditId=a.id)})):this.data.find((function(a){a.id==t.id&&confirm('Выдействительно хотите удалить группу "'+a.name+'" и все закрытия УП, закреплённые за этой группой?')&&o()({method:"delete",url:l.host+"/api/groups/"+t.id,headers:{Authorization:e.AuthStr}}).then((function(){})).catch((function(t){if("true"==t.response.data.error.messages[0])for(var n=0;n<e.data.length;n++)e.data[n].id==a.id&&e.data.splice(n,1);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+t)}))}))},loadUP:function(t,e,a,n,i){var d=this,r=this.data[t],s=this.$refs[e],u=!1;u=void 0!=s&&(1==n?!s[0].checked:s[0].checked),u?(""==a&&(a=l.host+"/api/groups/"+r.id+"/constructionCertificates"),void 0==i&&(i=[]),o()({method:"get",url:a+"?page="+n,headers:{Authorization:this.AuthStr}}).then((function(s){s.data.data.construction_certificates.forEach((function(t){i.push({id:t.id,options:[{id:"edit",text:"Редактировать",event:d.edit}],data:{number:{type:"number",value:t.number},name:{type:"text",value:t.name},plannedDate:{type:"date",value:null!=t.closing_date_planned?new Date(t.closing_date_planned).toLocaleDateString():""},closingDate:{type:"date",value:null!=t.closing_date_real?new Date(t.closing_date_real).toLocaleDateString():""},files:{type:"files",value:t.files,model:"constructionCertificates"}},subTable:{headers:["№ Рапорта/извещения","Наименование","Действующая документация  ПДСП, РКД","Дата предъявления","Дата закрытия","Фотографии и файлы"],rows:{}}}),1==d.role&&i[i.length-1].options.push({id:"delet",text:"Удалить",event:d.delet}),i[i.length-1].subTable.rows=[],t.reports.forEach((function(t){if(i[i.length-1].subTable.rows.push({id:t.id,options:[{id:"edit",text:"Редактировать",event:d.editReport},{id:"editPresentation",text:"Редактировать предъявления",event:d.editPresentation}],data:{number:{value:t.number,type:"text"},name:{value:t.name,type:"text"},documentation:{value:t.current_documentation,type:"text"},presentation:{value:t.presentations,type:"presentation"},closingDate:{value:null!=t.closing_date?new Date(t.closing_date).toLocaleDateString():"",type:"date"},files:{value:t.files,type:"files",model:"reports"}}}),1==d.role){var e=i[i.length-1].subTable.rows.length-1;i[i.length-1].subTable.rows[e].options.push({id:"delet",text:"Удалить",event:d.deletReport})}})),i[i.length-1].subTable.rows.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:t.id==e.id?0:void 0}))})),s.data.data.construction_certificates.length>0?(n+=1,d.loadUP(t,e,a,n,i)):(i.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:t.id==e.id?0:void 0})),r.subTable.rows=i)}))):r.subTable.rows=[]},add:function(t){var e=this;null==this.lastAddedId&&o()({method:"post",url:l.host+"/api/constructionCertificates/",data:"group_id="+t,headers:{Authorization:this.AuthStr}}).then((function(a){e.lastAddedId=a.data.data.id,e.data.forEach((function(n){n.id==t&&(n.subTable.rows.push({id:a.data.data.id,options:[{id:"edit",text:"Редактировать",event:e.edit}],data:{number:{type:"text",value:""},name:{type:"text",value:""},plannedDate:{type:"date",value:""},closingDate:{type:"date",value:""},files:{type:"files",value:"",model:"constructionCertificates"}},subTable:{headers:["№ Рапорта/извещения","Наименование","Действующая документация  ПДСП, РКД","Дата предъявления","Дата закрытия","Фотографии и файлы"],rows:[]}}),1==e.role&&n.subTable.rows[n.subTable.rows.length-1].options.push({id:"delet",text:"Удалить",event:e.delet}),n.subTable.rows[n.subTable.rows.length-1].subTable.rows=[],e.lastAddedId=a.data.data.id)}))}))},edit:function(t,e){var a=this,n=["number","name","closing_date_planned","closing_date_real","files"],i={};t.forEach((function(t,e){""!=t&null!=t&void 0!=t|2==e|3==e&&(i[n[e]]=t)})),o.a.put(l.host+"/api/constructionCertificates/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){n.subTable.rows.forEach((function(n){if(n.id==e){n.data.number.value=t.data.data.number,n.data.name.value=t.data.data.name;var i=null!=t.data.data.closing_date_planned?new Date(t.data.data.closing_date_planned).toLocaleDateString():"",d=null!=t.data.data.closing_date_real?new Date(t.data.data.closing_date_real).toLocaleDateString():"";n.data.plannedDate.value=i,n.data.closingDate.value=d,n.data.files.value=t.data.data.files,a.lastAddedId=null}}))}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o.a.delete(l.host+"/api/constructionCertificates/"+t,{headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=function(a){for(var n=0;n<e.data[a].subTable.rows.length;n++)e.data[a].subTable.rows[n].id==t&&function(){e.data[a].subTable.rows.splice(n,1);var t=e.data[a].subTable.rows;e.data[a].subTable.rows=[],setTimeout((function(){e.data[a].subTable.rows=t}),10)}()},i=0;i<e.data.length;i++)n(i);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},addRaport:function(t){var e=this;null==this.lastAddedReportId&&o()({method:"post",url:l.host+"/api/reports",data:"construction_certificate_id="+t,headers:{Authorization:this.AuthStr}}).then((function(a){e.data.forEach((function(n){n.subTable.rows.forEach((function(n){if(n.id==t&&(n.subTable.rows.push({id:a.data.data.id,options:[{id:"edit",text:"Редактировать",event:e.editReport},{id:"editPresentation",text:"Редактировать предъявления",event:e.editPresentation}],data:{number:{value:"",type:"text"},name:{value:"",type:"text"},documentation:{value:"",type:"text"},presentation:{value:{},type:"presentation"},closingDate:{value:null,type:"date"},files:{value:[],type:"files",model:"constructionCertificates"}}}),1==e.role)){var i=n.subTable.rows.length-1;n.subTable.rows[i].options.push({id:"delet",text:"Удалить",event:e.deletReport})}}))})),e.lastAddedReportId=a.data.data.id,e.update()}))},editReport:function(t,e){var a=this,n=["number","name","current_documentation","closing_date"],i={};t.forEach((function(t,e){""!=t&null!=t&void 0!=t|3==e&&(i[n[e]]=t)})),o()({method:"put",url:l.host+"/api/reports/"+e,data:i,headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(a){a.subTable.rows.forEach((function(a){a.subTable.rows.forEach((function(a){a.id==e&&(a.data.number.value=t.data.data.number,a.data.name.value=t.data.data.name,a.data.documentation.value=t.data.data.current_documentation,a.data.presentation.value=t.data.data.presentations,a.data.closingDate.value=null!=t.data.data.closing_date?new Date(t.data.data.closing_date).toLocaleDateString():"",a.data.files.value=t.data.data.files)}))}))})),a.lastAddedReportId=null})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedReportId=e,a.update()}))},deletReport:function(t){var e=this;confirm("Вы действительно хотите удалить этот рапорт?")&&o()({method:"delete",url:l.host+"/api/reports/"+t,headers:{Authorization:this.AuthStr}}).then((function(){})).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=function(a){for(var n=function(n){for(var i=0;i<e.data[a].subTable.rows[n].subTable.rows.length;i++)e.data[a].subTable.rows[n].subTable.rows[i].id==t&&function(){e.data[a].subTable.rows[n].subTable.rows.splice(i,1);var t=e.data[a].subTable.rows[n].subTable.rows;e.data[a].subTable.rows[n].subTable.rows=[],setTimeout((function(){e.data[a].subTable.rows[n].subTable.rows=t}),50)}()},i=0;i<e.data[a].subTable.rows.length;i++)n(i)},i=0;i<e.data.length;i++)n(i);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},editPresentation:function(t){var e=this;this.$emit("presentation",{id:t,model:"reports"},(function(a){e.data.forEach((function(e){e.subTable.rows.forEach((function(e){e.subTable.rows.forEach((function(e){e.id==t&&(e.data.presentation.value=a)}))}))}))}))},update:function(){var t=this;null!=this.lastAddedId&&this.data.forEach((function(e){e.subTable.rows.forEach((function(a){a.id==t.lastAddedId&&(t.$refs["table"+e.id][0].$refs[t.lastAddedId][0].isEdit=!0,t.$refs["table"+e.id][0].$refs[t.lastAddedId][0].event=t.edit)}))})),null!=this.lastAddedReportId&&this.data.forEach((function(e){e.subTable.rows.forEach((function(a){a.subTable.rows.forEach((function(n){n.id==t.lastAddedReportId&&setTimeout((function(){t.$refs["table"+e.id][0].$refs[a.id][0].$refs["subTable"+a.id].$refs[t.lastAddedReportId][0].isEdit=!0,t.$refs["table"+e.id][0].$refs[a.id][0].$refs["subTable"+a.id].$refs[t.lastAddedReportId][0].event=t.editReport}),10)}))}))}))},addGroup:function(t,e){var a={};a.id=t.id,a.name=t.name,a.isEdit=!1,a.options=[],1==this.role&&(a.options.push({id:"edit",text:"Редактировать",event:this.groupTools}),a.options.push({id:"delet",text:"Удалить",event:this.groupTools})),a.subTable={headers:["№ УП","Наименование УП","Плановая дата закрытия УП","Дата закрытия УП","Необходимые файлы"]},a.subTable.rows=[],this.groupPreloader.push(a),e&&(this.data[this.data.length-1].isEdit=!0,this.groupEditId=this.data[this.data.length-1].id)},addToGroup:function(t,e){var a=this;t.subTable.rows=[],o()({method:"get",url:l.host+"/api/groups/"+e+"/constructionCertificates",headers:{Authorization:this.AuthStr}}).then((function(e){e.data.data.construction_certificates.forEach((function(e){t.subTable.rows.splice(t.subTable.rows.length,0,{id:e.id,options:[{id:"edit",text:"Редактировать",event:a.edit}],data:{number:{type:"text",value:e.number},name:{type:"text",value:e.name},plannedDate:{type:"date",value:null!=e.closing_date_planned?new Date(e.closing_date_planned).toLocaleDateString():""},closingDate:{type:"date",value:null!=e.closing_date_real?new Date(e.closing_date_real).toLocaleDateString():""},files:{type:"files",value:e.files,model:"constructionCertificates"}},subTable:{headers:["№ Рапорта/извещения","Наименование","Действующая документация  ПДСП, РКД","Дата предъявления","Дата закрытия","Фотографии и файлы"],rows:[]}}),1==a.role&&t.subTable.rows[t.subTable.rows.length-1].options.push({id:"delet",text:"Удалить",event:a.delet}),e.reports.forEach((function(e){if(t.subTable.rows[t.subTable.rows.length-1].subTable.rows=[],t.subTable.rows[t.subTable.rows.length-1].subTable.rows.push({id:e.id,options:[{id:"edit",text:"Редактировать",event:a.editReport},{id:"editPresentation",text:"Редактировать предъявления",event:a.editPresentation}],data:{number:{value:e.number,type:"text"},name:{value:e.name,type:"text"},documentation:{value:e.current_documentation,type:"text"},presentation:{value:e.presentations,type:"presentation"},closingDate:{value:e.closing_date,type:"text"},files:{value:e.files,type:"files",model:"reports"}}}),1==a.role){var n=t.subTable.rows.length-1,i=t.subTable.rows[n].subTable.rows.length-1;t.subTable.rows[n].subTable.rows[i].options.push({id:"delet",text:"Удалить",event:a.deletReport})}})),a.lastAddedId=e.id}))}))},loadGroups:function(t,e){var a=this;o.a.get(t+"?page="+e,{headers:{Authorization:this.AuthStr}}).then((function(n){n.data.data.groups.forEach((function(t){a.addGroup(t,!1)})),n.data.data.groups.length>0?(e+=1,a.loadGroups(t,e)):(a.groupPreloader.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:t.id==e.id?0:void 0})),a.data=a.groupPreloader)}))}},created:function(){this.role=sessionStorage.getItem("role"),this.loadGroups(l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/groups",1)},updated:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.groupEditId?this.data.find((function(e){e.id==t.groupEditId&&(document.onkeypress=function(a){13==a.keyCode&&o()({method:"put",url:l.host+"/api/groups/"+e.id,data:"name="+e.name,headers:{Authorization:t.AuthStr}}).then((function(){e.isEdit=!1,t.groupEditId=null}))})})):document.onkeypress=null}},oa=sa,la=(a("7f8f"),Object(f["a"])(oa,da,ra,!1,null,null,null)),ua=la.exports,ca=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table-view",{ref:"table",staticStyle:{width:"auto",height:"auto"},attrs:{headers:t.headers,columns:"grid-template-columns: repeat(3, minmax(300px, 1fr)) 500px repeat(3, minmax(300px, 1fr)) 40px;",data:t.data,inRowAdd:!0},on:{sort:t.sort,addRow:t.add,update:t.update,addInnerDate:t.addInnerDate,loadData:t.loadNewData}})},ha=[];n["a"].component("table-view",rt);var pa={data:function(){return{headers:["№ УШ","Наименование УШ","Действующая документация","Дата предъявления","Плановая дата закрытия УШ","Дата закрытия","Фотографии и необходимые файлы"],data:[],affterDeleting:null,lastAddedId:null,role:0,maxData:5,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/mooringCertificates/","contract_object_id="+this.$router.history.current.params.idObject,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"editPresentation",text:"Редактировать предъявления",event:t.editPresentation},{id:"delet",text:"Удалить",event:t.delet}],data:{namber:{value:"",type:"text"},name:{value:"",type:"text"},documentation:{value:"",type:"text"},presentation:{value:[],type:"presentation"},plannedDate:{value:"",type:"date"},realDate:{value:"",type:"date"},files:{value:"",type:"files",model:"mooringCertificates"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){for(var a=this,n=["number","name","current_documentation","closing_date_planned","closing_date_real"],i={},d=0;d<t.length;d++)""!=t[d]&null!=t[d]&void 0!=t|3==d|4==d&&(i[n[d]]=t[d]);o.a.put(l.host+"/api/mooringCertificates/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){var i=null!=t.data.data.closing_date_planned?new Date(t.data.data.closing_date_planned).toLocaleDateString():"",d=null!=t.data.data.closing_date_real?new Date(t.data.data.closing_date_real).toLocaleDateString():"";n.data.namber.value=t.data.data.number,n.data.name.value=t.data.data.name,n.data.documentation.value=t.data.data.current_documentation,n.data.presentation.value=t.data.data.presentations,n.data.plannedDate.value=i,n.data.realDate.value=d,n.data.files.value=t.data.data.files,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o.a.delete(l.host+"/api/mooringCertificates/"+t,{headers:{Authorization:this.AuthStr}}).then((function(){for(var a=0;a<e.data.length;a++)if(e.data[a].id==t)return void e.data.splice(a,1)})).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},addInnerDate:function(t,e){var a=this;""!=e?this.data.forEach((function(n){n.id==t&&o()({method:"post",url:l.host+"/api/presentations",data:{model_id:t,model_type:"mooring_certificates",date:e},headers:{Authorization:a.AuthStr}}).then((function(t){console.log(t)}))})):alert("Ошибка!\r\rПожалуйста укажите дату.")},editPresentation:function(t){var e=this;this.$emit("presentation",{id:t,model:"mooringCertificates"},(function(a){e.data.forEach((function(e){e.id==t&&(e.data.presentation.value=a)}));var n=e.data;e.data=[],e.data=n}))},loadNewData:function(t){this.loadData(l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/mooringCertificates",t,this.data)},loadData:function(t,e,a){var n=this;void 0==a&&(a=[]),o.a.get(t+"?page="+e,{headers:{Authorization:this.AuthStr}}).then((function(i){i.data.data.mooring_certificates.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"editPresentation",text:"Редактировать предъявления",event:n.editPresentation}],1==n.role&&e.options.push({id:"delet",text:"Удалить",event:n.delet});var i=null!=t.closing_date_planned?new Date(t.closing_date_planned).toLocaleDateString():"",d=null!=t.closing_date_real?new Date(t.closing_date_real).toLocaleDateString():"";e.data={},e.data.namber={},e.data.namber.value=t.number,e.data.namber.type="text",e.data.name={},e.data.name.value=t.name,e.data.name.type="text",e.data.documentation={},e.data.documentation.value=t.current_documentation,e.data.documentation.type="text",e.data.presentation={},e.data.presentation.type="presentation",e.data.presentation.value=t.presentations,e.data.plannedDate={},e.data.plannedDate.value=i,e.data.plannedDate.type="date",e.data.realDate={},e.data.realDate.value=d,e.data.realDate.type="date",e.data.files={},e.data.files.value=t.files,e.data.files.type="files",e.data.files.model="mooringCertificates",a.push(e)})),i.data.data.mooring_certificates.length>0&e!=n.maxData?(e+=1,n.loadData(t,e,a)):(n.maxData+=5,n.$refs.table.manyQueries=e+1,a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.role=sessionStorage.getItem("role"),this.loadData(l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/mooringCertificates",1)}},fa=pa,va=Object(f["a"])(fa,ca,ha,!1,null,null,null),ma=va.exports,ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table-view",{ref:"table",staticStyle:{width:"auto",height:"auto"},attrs:{headers:t.headers,data:t.data,inRowAdd:!0,columns:"grid-template-columns: repeat(3, minmax(300px, 1fr)) 500px repeat(3, minmax(300px, 1fr)) 40px;"},on:{sort:t.sort,addRow:t.add,update:t.update,loadData:t.loadNewData}})},ga=[];n["a"].component("table-view",rt);var _a={data:function(){return{headers:["№ УХ","Наименование УХ","Действующая документация","Дата предъявления","Плановая дата закрытия УХ","Дата закрытия","Фотографии и необходимые файлы"],data:[],affterDeleting:null,lastAddedId:null,role:0,maxData:5,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/travelingCertificates","contract_object_id="+this.$router.history.current.params.idObject,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"editPresentation",text:"Редактировать предъявления",event:t.editPresentation},{id:"delet",text:"Удалить",event:t.delet}],data:{namber:{value:"",type:"text"},name:{value:"",type:"text"},documentation:{value:"",type:"text"},presentation:{value:"",type:"presentation"},plannedDate:{value:"",type:"date"},realDate:{value:"",type:"date"},files:{value:"",type:"files",model:"travelingCertificates"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){for(var a=this,n=["number","name","documentation","closing_date_planned","closing_date_real"],i={},d=0;d<t.length;d++)""!=t[d]&null!=t[d]&void 0!=t|3==d|4==d&&(i[n[d]]=t[d]);o.a.put(l.host+"/api/travelingCertificates/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){var i=null!=t.data.data.closing_date_planned?new Date(t.data.data.closing_date_planned).toLocaleDateString():"",d=null!=t.data.data.closing_date_real?new Date(t.data.data.closing_date_real).toLocaleDateString():"";n.data.namber.value=t.data.data.number,n.data.name.value=t.data.data.name,n.data.documentation.value=t.data.data.current_documentation,n.data.presentation.value=t.data.data.presentations,n.data.plannedDate.value=i,n.data.realDate.value=d,n.data.files.value=t.data.data.files,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},editPresentation:function(t){var e=this;this.$emit("presentation",{id:t,model:"travelingCertificates"},(function(a){e.data.forEach((function(e){e.id==t&&(e.data.presentation.value=a)}))}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o.a.delete(l.host+"/api/travelingCertificates/"+t,{headers:{Authorization:this.AuthStr}}).then((function(){for(var a=0;a<e.data.length;a++)if(e.data[a].id==t)return void e.data.splice(a,1)})).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadNewData:function(t){this.loadData(l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/travelingCertificates",t,this.data)},loadData:function(t,e,a){var n=this;void 0==a&&(a=[]),o.a.get(t+"?page="+e,{headers:{Authorization:this.AuthStr}}).then((function(i){i.data.data.traveling_certificates.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"editPresentation",text:"Редактировать предъявления",event:n.editPresentation}],1==n.role&&e.options.push({id:"delet",text:"Удалить",event:n.delet});var i=null!=t.closing_date_planned?new Date(t.closing_date_planned).toLocaleDateString():"",d=null!=t.closing_date_real?new Date(t.closing_date_real).toLocaleDateString():"";e.data={},e.data.namber={},e.data.namber.value=t.number,e.data.namber.type="text",e.data.name={},e.data.name.value=t.name,e.data.name.type="text",e.data.documentation={},e.data.documentation.value=t.current_documentation,e.data.documentation.type="text",e.data.presentation={},e.data.presentation.value=t.presentations,e.data.presentation.type="presentation",e.data.plannedDate={},e.data.plannedDate.value=i,e.data.plannedDate.type="date",e.data.realDate={},e.data.realDate.value=d,e.data.realDate.type="date",e.data.files={},e.data.files.value=t.files,e.data.files.type="files",e.data.files.model="travelingCertificates",a.push(e)})),i.data.data.traveling_certificates.length>0&e!=n.maxData?(e+=1,n.loadData(t,e,a)):(n.maxData+=5,1!=e&&(n.$refs.table.manyQueries=e+1),a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.role=sessionStorage.getItem("role"),this.loadData(l.host+"/api/objects/"+this.$router.history.current.params.idObject+"/travelingCertificates",1)}},ya=_a,wa=Object(f["a"])(ya,ba,ga,!1,null,null,null),xa=wa.exports,Aa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%",display:"grid","grid-template-rows":"auto 1fr"}},[a("div",[a("button",{staticClass:"add-row",on:{click:function(e){return t.add()}}},[t._v("Добавить новый этап")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{headers:t.headers,data:t.data,groupBy:"objectName",sortBy:"dateEndPlan"},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)])},Sa=[];n["a"].component("table-view",rt);var Da={data:function(){return{headers:["Наименование объекта по ГК","Наименование этапа","Стоимость этапа","Дата начала","Дата окончания (план)","Дата окончания (факт)","Обоснование","Примечание"],data:[],newKeyEventsId:null,affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/paymentStages","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){o.a.post(l.host+"/api/keyEvents","contract_id="+t.$router.history.current.params.id,{headers:{Authorization:t.AuthStr}}).then((function(e){t.newKeyEventsId=e.data.data.id})),t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{objectName:{value:"",type:"text"},stageName:{value:"",type:"text"},amount:{value:"",type:"number"},dateStart:{value:"",type:"date"},dateEndPlan:{value:"",type:"date"},dateEndReal:{value:"",type:"date"},rationale:{value:"",type:"text"},note:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n=["object_name","name","amount","start_date","expiration_date_planned","expiration_date_real","rationale","note"],i={},d={};t.forEach((function(t,e){""!=t&null!=t&void 0!=t|3==e|4==e|5==e&&(i[n[e]]=t),null!=a.newKeyEventsId&&2!=e&&""!=t&null!=t&void 0!=t|3==e|4==e|5==e&&(d[n[e]]=t)})),o.a.put(l.host+"/api/paymentStages/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.newKeyEventsId&&o.a.put(l.host+"/api/keyEvents/"+a.newKeyEventsId,d,{headers:{Authorization:a.AuthStr}}).then((function(){})),a.data.find((function(n){if(n.id==e){n.data.objectName.value=t.data.data.object_name,n.data.stageName.value=t.data.data.name,n.data.amount.value=t.data.data.amount?parseFloat(t.data.data.amount).toLocaleString():"";var i=null!=t.data.data.start_date?new Date(t.data.data.start_date).toLocaleDateString():"",d=null!=t.data.data.expiration_date_planned?new Date(t.data.data.expiration_date_planned).toLocaleDateString():"",r=null!=t.data.data.expiration_date_real?new Date(t.data.data.expiration_date_real).toLocaleDateString():"";n.data.dateStart.value=i,n.data.dateEndPlan.value=d,n.data.dateEndReal.value=r,n.data.note.value=t.data.data.note,n.data.rationale.value=t.data.data.rationale,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить данную запись?")&&o()({method:"delete",url:l.host+"/api/paymentStages/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.payment_stages.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}];var i=null!=t.start_date?new Date(t.start_date).toLocaleDateString():"",d=null!=t.expiration_date_planned?new Date(t.expiration_date_planned).toLocaleDateString():"",r=null!=t.expiration_date_real?new Date(t.expiration_date_real).toLocaleDateString():"";e.data={},e.data.objectName={},e.data.objectName.value=t.object_name,e.data.objectName.type="text",e.data.stageName={},e.data.stageName.value=t.name,e.data.stageName.type="text",e.data.amount={},e.data.amount.value=t.amount?parseFloat(t.amount).toLocaleString():"",e.data.amount.type="number",e.data.dateStart={},e.data.dateStart.value=i,e.data.dateStart.type="date",e.data.dateEndPlan={},e.data.dateEndPlan.value=d,e.data.dateEndPlan.type="date",e.data.dateEndReal={},e.data.dateEndReal.value=r,e.data.dateEndReal.type="date",e.data.rationale={},e.data.rationale.value=t.rationale,e.data.rationale.type="text",e.data.note={},e.data.note.value=t.note,e.data.note.type="text",a.push(e)})),i.data.data.payment_stages.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/paymentStages",1)}},ka=Da,Ia=Object(f["a"])(ka,Aa,Sa,!1,null,null,null),$a=Ia.exports,Ca=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%",display:"grid","grid-template-rows":"auto 1fr"}},[a("div",[a("button",{staticClass:"add-row",on:{click:function(e){return t.add()}}},[t._v("Добавить новое событие")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{headers:t.headers,data:t.data,groupBy:"objectName",sortBy:"dateEndPlan"},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)])},Ea=[];n["a"].component("table-view",rt);var ja={data:function(){return{headers:["Наименование объекта","Наименование события","Ответственный","Дата начала","Дата окончания (план)","Дата окончания (факт)","Обоснование","Примечание"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/keyEvents","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{objectName:{value:"",type:"text"},name:{value:"",type:"text"},responsible:{value:"",type:"text"},dateStart:{value:"",type:"date"},dateEndPlan:{value:"",type:"date"},dateEndReal:{value:"",type:"date"},rationale:{value:"",type:"text"},note:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n=["object_name","name","responsible","start_date","expiration_date_planned","expiration_date_real","rationale","note"],i={};t.forEach((function(t,e){""!=t&null!=t&void 0!=t|3==e|4==e|5==e&&(i[n[e]]=t)})),o.a.put(l.host+"/api/keyEvents/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){n.data.objectName.value=t.data.data.object_name,n.data.name.value=t.data.data.name,n.data.responsible.value=t.data.data.responsible;var i=null!=t.data.data.start_date?new Date(t.data.data.start_date).toLocaleDateString():"",d=null!=t.data.data.expiration_date_planned?new Date(t.data.data.expiration_date_planned).toLocaleDateString():"",r=null!=t.data.data.expiration_date_real?new Date(t.data.data.expiration_date_real).toLocaleDateString():"";n.data.dateStart.value=i,n.data.dateEndPlan.value=d,n.data.dateEndReal.value=r,n.data.note.value=t.data.data.note,n.data.rationale.value=t.data.data.rationale,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить это событие?")&&o()({method:"delete",url:l.host+"/api/keyEvents/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.key_events.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}];var i=null!=t.start_date?new Date(t.start_date).toLocaleDateString():"",d=null!=t.expiration_date_planned?new Date(t.expiration_date_planned).toLocaleDateString():"",r=null!=t.expiration_date_real?new Date(t.expiration_date_real).toLocaleDateString():"";e.data={},e.data.objectName={},e.data.objectName.value=t.object_name,e.data.objectName.type="text",e.data.name={},e.data.name.value=t.name,e.data.name.type="text",e.data.responsible={},e.data.responsible.value=t.responsible,e.data.responsible.type="text",e.data.dateStart={},e.data.dateStart.value=i,e.data.dateStart.type="date",e.data.dateEndPlan={},e.data.dateEndPlan.value=d,e.data.dateEndPlan.type="date",e.data.dateEndReal={},e.data.dateEndReal.value=r,e.data.dateEndReal.type="date",e.data.rationale={},e.data.rationale.value=t.rationale,e.data.rationale.type="text",e.data.note={},e.data.note.value=t.note,e.data.note.type="text",a.push(e)})),i.data.data.key_events.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/keyEvents",1)}},Ta=ja,Oa=Object(f["a"])(Ta,Ca,Ea,!1,null,null,null),Pa=Oa.exports,La=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row double-table-button",on:{click:function(e){return t.add()}}},[t._v("Добавить новую претензионную работу")])]),a("table-view",{ref:"table",staticStyle:{width:"auto",height:"auto"},attrs:{headers:t.headers,data:t.data,groupBy:"object",sortBy:"date"},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)},za=[];n["a"].component("table-view",rt);var Ra={data:function(){return{headers:["Объект","Дата","Номер требования","Причина выставления требования","Сумма требования, руб.","Статус исполнения требования"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/claimWorks/","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{object:{value:"",type:"text"},date:{value:"",type:"date"},number:{value:"",type:"text"},reason:{value:"",type:"text"},amount:{value:"",type:"number"},status:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n=["object_name","date","number","cause","amount","status"],i={};t.forEach((function(t,e){""!=t&null!=t&void 0!=t|1==e&&(i[n[e]]=t)})),o.a.put(l.host+"/api/claimWorks/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){var i=null!=t.data.data.date?new Date(t.data.data.date).toLocaleDateString():"";n.data.object.value=t.data.data.object_name,n.data.date.value=i,n.data.number.value=t.data.data.number,n.data.reason.value=t.data.data.cause,n.data.amount.value=t.data.data.amount?parseFloat(t.data.data.amount).toLocaleString():"",n.data.status.value=t.data.data.status,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o()({method:"delete",url:l.host+"/api/claimWorks/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.claim_works.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}];var i=null!=t.date?new Date(t.date).toLocaleDateString():"";e.data={},e.data.object={},e.data.object.value=t.object_name,e.data.object.type="text",e.data.date={},e.data.date.value=i,e.data.date.type="date",e.data.number={},e.data.number.value=t.number,e.data.number.type="text",e.data.reason={},e.data.reason.value=t.cause,e.data.reason.type="text",e.data.amount={},e.data.amount.value=t.amount?parseFloat(t.amount).toLocaleString():"",e.data.amount.type="number",e.data.status={},e.data.status.value=t.status,e.data.status.type="text",a.push(e)})),i.data.data.claim_works.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/claimWorks",1)}},Na=Ra,Ba=Object(f["a"])(Na,La,za,!1,null,null,null),Fa=Ba.exports,Ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row double-table-button",on:{click:function(e){return t.add()}}},[t._v("Добавить новую судебную работу")])]),a("table-view",{ref:"table",staticStyle:{width:"auto",height:"auto"},attrs:{headers:t.headers,data:t.data},on:{sort:t.sort,addRow:t.add,update:t.update}})],1)},Ga=[];n["a"].component("table-view",rt);var Wa={data:function(){return{headers:["Дата","Номер","Наименование искового заявления","Номер судебного дела","Истец","Ответчик","Третьи лица","Предмет спора","Дата судебного заседания","Стадия рассмотрения искового заявления","Результат рассмотрения искового заявления"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{sort:function(t){var e=this;this.data=[],setTimeout((function(){t.forEach((function(t){e.data.push(t)}))}),5)},add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/judicialWorks/","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){t.lastAddedId=e.data.data.id;var a=t.data;a.unshift({id:e.data.data.id,options:[{id:"edit",text:"Редактировать",event:t.edit},{id:"delet",text:"Удалить",event:t.delet}],data:{date:{value:"",type:"date"},number:{value:"",type:"text"},name:{value:"",type:"text"},judicalNumber:{value:"",type:"text"},plaintiff:{value:"",type:"text"},defendant:{value:"",type:"text"},thirdParties:{value:"",type:"text"},object:{value:"",type:"text"},judicalDate:{value:"",type:"date"},stage:{value:"",type:"text"},result:{value:"",type:"text"}}}),t.affterDeleting=a}))},update:function(){var t=this;null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n=["statement_claim_date","statement_claim_number","statement_claim_name","court_case_number","plaintiff","defendant","third_parties","matter_dispute","court_hearing_date","statement_claim_status","statement_claim_result"],i={};t.forEach((function(t,e){""!=t&null!=t&void 0!=t|0==e|8==e&&(i[n[e]]=t)})),o.a.put(l.host+"/api/judicialWorks/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data.find((function(n){if(n.id==e){var i=null!=t.data.data.statement_claim_date?new Date(t.data.data.statement_claim_date).toLocaleDateString():"",d=null!=t.data.data.court_hearing_date?new Date(t.data.data.court_hearing_date).toLocaleDateString():"";n.data.date.value=i,n.data.number.value=t.data.data.statement_claim_number,n.data.name.value=t.data.data.statement_claim_name,n.data.judicalNumber.value=t.data.data.court_case_number,n.data.plaintiff.value=t.data.data.plaintiff,n.data.defendant.value=t.data.data.defendant,n.data.thirdParties.value=t.data.data.third_parties,n.data.object.value=t.data.data.matter_dispute,n.data.judicalDate.value=d,n.data.stage.value=t.data.data.statement_claim_status,n.data.result.value=t.data.data.statement_claim_result,a.lastAddedId=null}}))})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o()({method:"delete",url:l.host+"/api/judicialWorks/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e,a){var n=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(i){void 0==a&&(a=[]),i.data.data.judicial_works.forEach((function(t){var e={};e.id=t.id,e.options=[{id:"edit",text:"Редактировать",event:n.edit},{id:"delet",text:"Удалить",event:n.delet}];var i=null!=t.statement_claim_date?new Date(t.statement_claim_date).toLocaleDateString():"",d=null!=t.court_hearing_date?new Date(t.court_hearing_date).toLocaleDateString():"";e.data={},e.data.date={},e.data.date.value=i,e.data.date.type="date",e.data.number={},e.data.number.value=t.statement_claim_number,e.data.number.type="text",e.data.name={},e.data.name.value=t.statement_claim_name,e.data.name.type="text",e.data.judicalNumber={},e.data.judicalNumber.value=t.court_case_number,e.data.judicalNumber.type="text",e.data.plaintiff={},e.data.plaintiff.value=t.plaintiff,e.data.plaintiff.type="text",e.data.defendant={},e.data.defendant.value=t.defendant,e.data.defendant.type="text",e.data.thirdParties={},e.data.thirdParties.value=t.third_parties,e.data.thirdParties.type="text",e.data.object={},e.data.object.value=t.matter_dispute,e.data.object.type="text",e.data.judicalDate={},e.data.judicalDate.value=d,e.data.judicalDate.type="date",e.data.stage={},e.data.stage.value=t.statement_claim_status,e.data.stage.type="text",e.data.result={},e.data.result.value=t.statement_claim_result,e.data.result.type="text",a.push(e)})),i.data.data.judicial_works.length>0?(e+=1,n.loadData(t,e,a)):(a.sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:t.id==e.id?0:void 0})),n.data=a)}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/claimWorks",1)}},Ma=Wa,Ya=Object(f["a"])(Ma,Ua,Ga,!1,null,null,null),Ha=Ya.exports,Ja=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-button-wrap"},[a("div",[a("button",{staticClass:"add-row",style:this.data.length>0?"visibility: hidden":"",on:{click:function(e){return t.add()}}},[t._v("Добавить новое кассовое исполнение")])]),a("div",{staticClass:"table-wrapper"},[a("table-view",{ref:"table",attrs:{noSort:"true",alwaysUpdate:!0,headers:t.headers,data:t.data},on:{addRow:t.add,update:t.update}})],1)])},Qa=[];n["a"].component("table-view",rt);var qa={data:function(){return{headers:["Наименование объекта по ГК","Наименование этапа/аванс","Стоимость этапа/аванс","Оплаченная сумма по КС","Остаток незакрытого аванса по контракту нарастающим итогом","Дата оплаты","Примечание"],data:[],affterDeleting:null,lastAddedId:null,AuthStr:(sessionStorage.getItem("token_type")+" ").concat(sessionStorage.getItem("access_token"))}},methods:{add:function(){var t=this;null==this.lastAddedId&&o.a.post(l.host+"/api/cashExecutions","contract_id="+this.$router.history.current.params.id,{headers:{Authorization:this.AuthStr}}).then((function(e){var a;t.lastAddedId=e.data.data.id,a=t.data.length>0?{id:e.data.data.id,isGrey:!1,options:[{id:"add",text:"Редактировать",event:t.add},{id:"delet",text:"Удалить",event:t.delet}],data:{objectName:{value:t.data[0].data.objectName.value,type:"text"},stageName:{value:t.data[0].data.stageName.value,type:"text"},price:{value:t.data[0].data.price.value,type:"number"},amount_paid:{value:t.data[0].data.amount_paid.value,type:"number"},advance_balance:{value:t.data[0].data.advance_balance.value,type:"number"},date:{value:t.data[0].data.date.value,type:"date"},note:{value:t.data[0].data.note.value,type:"text"}}}:{id:e.data.data.id,isGrey:!1,options:[{id:"add",text:"Редактировать",event:t.add},{id:"delet",text:"Удалить",event:t.delet}],data:{objectName:{value:"",type:"text"},stageName:{value:"",type:"text"},price:{value:"",type:"number"},amount_paid:{value:"",type:"number"},advance_balance:{value:"",type:"number"},date:{value:"",type:"date"},note:{value:"",type:"text"}}},t.data.splice(0,0,a),t.data[1].options.splice(0,1),t.data[1].isGrey=!0,t.data[0].options=[{id:"add",text:"Редактировать",event:t.add},{id:"delet",text:"Удалить",event:t.delet}],a=t.data,t.data=[],setTimeout((function(){t.data=a}),10)}))},update:function(){var t=this;console.log(this.affterDeleting),null!=this.affterDeleting&&(this.data=[],setTimeout((function(){t.affterDeleting[0].isGrey=!1,"add"!=t.affterDeleting[0].options[0].id&&t.affterDeleting[0].options.splice(0,0,{id:"add",text:"Редактирование",event:t.add}),t.data=t.affterDeleting,t.affterDeleting=null}),100)),null!=this.lastAddedId&&(this.$refs.table.$refs[this.lastAddedId][0].isEdit=!0,this.$refs.table.$refs[this.lastAddedId][0].event=this.edit)},edit:function(t,e){var a=this,n=["object_name","stage_name","price","amount_paid","advance_balance","payment_date","note"],i={};t.forEach((function(t,e){null!=t&""!=t&void 0!=t|5==e&&(i[n[e]]=t)})),o.a.put(l.host+"/api/cashExecutions/"+e,i,{headers:{Authorization:this.AuthStr}}).then((function(t){a.data[0].data.objectName.value=t.data.data.object_name,a.data[0].data.stageName.value=t.data.data.stage_name,a.data[0].data.price.value=t.data.data.price?parseFloat(t.data.data.price).toLocaleString():"",a.data[0].data.amount_paid.value=t.data.data.amount_paid?parseFloat(t.data.data.amount_paid).toLocaleString():"",a.data[0].data.advance_balance.value=t.data.data.advance_balance?parseFloat(t.data.data.advance_balance).toLocaleString():"";var e=null!=t.data.data.payment_date?new Date(t.data.data.payment_date).toLocaleDateString():"";a.data[0].data.date.value=e,a.data[0].data.note.value=t.data.data.note,a.lastAddedId=null})).catch((function(t){alert("Ошибка!\r\rПроверьте введённые данные и повторите попытку.\r\rИнформация об ошибке:\r"+t),a.lastAddedId=e,a.update()}))},delet:function(t){var e=this;confirm("Вы действительно хотите удалить эту запись?")&&o()({method:"delete",url:l.host+"/api/cashExecutions/"+t,headers:{Authorization:this.AuthStr}}).catch((function(a){if("true"==a.response.data.error.messages[0])for(var n=e.data.slice(0),i=0;i<n.length;i++)n[i].id==t&&(n.splice(i,1),e.affterDeleting=n,e.data=n);else alert("Ошибка!\r\rНе удалось удалить элемент.\r\rИнформация об ошибке:\r"+a)}))},loadData:function(t,e){var a=this;o()({method:"get",url:t+"?page="+e,headers:{Authorization:this.AuthStr}}).then((function(n){if(n.data.data.cash_executions.forEach((function(t){var e={};e.id=t.id,e.options=[],e.isGrey=!0,e.options.push({id:"delet",text:"Удалить",event:a.delet});var n=null!=t.payment_date?new Date(t.payment_date).toLocaleDateString():"";e.data={},e.data.objectName={},e.data.objectName.value=t.object_name,e.data.objectName.type="text",e.data.stageName={},e.data.stageName.value=t.stage_name,e.data.stageName.type="text",e.data.price={},e.data.price.value=t.price?parseFloat(t.price).toLocaleString():"",e.data.price.type="number",e.data.amount_paid={},e.data.amount_paid.value=t.amount_paid?parseFloat(t.amount_paid).toLocaleString():"",e.data.amount_paid.type="number",e.data.advance_balance={},e.data.advance_balance.value=t.advance_balance?parseFloat(t.advance_balance).toLocaleString():"",e.data.advance_balance.type="number",e.data.date={},e.data.date.value=n,e.data.date.type="date",e.data.note={},e.data.note.value=t.note,e.data.note.type="text",a.data.push(e)})),n.data.data.cash_executions.length>0)e+=1,a.loadData(t,e);else{var i=a.data;a.data=[],i.sort((function(t,e){return t.id<e.id?1:t.id>e.id?-1:t.id==e.id?0:void 0})),i[0].isGrey=!1,i[0].options.splice(0,0,{id:"add",text:"Редактировать",event:a.add}),setTimeout((function(){a.data=i}),10)}}))}},created:function(){this.loadData(l.host+"/api/contracts/"+this.$router.history.current.params.id+"/cashExecutions",1)}},Ka=qa,Xa=Object(f["a"])(Ka,Ja,Qa,!1,null,null,null),Va=Xa.exports;n["a"].use(i["a"]);var Za=new i["a"]({mode:"history",base:"/",routes:[{path:"/login",component:y},{path:"/users",component:ut},{path:"/watcher",component:Vt,children:[{path:"/watcher/objects/",component:ie},{path:"/watcher/objects/:idObject",component:ue,children:[{path:"/watcher/objects/:idObject/UP",component:ua},{path:"/watcher/objects/:idObject/USh",component:ma},{path:"/watcher/objects/:idObject/UH",component:xa}]}]},{path:"/main",component:T,children:[{path:"",component:Pt},{path:"/deal/:id",component:Et,children:[{path:"/deal/:id/ship-info",component:me},{path:"/deal/:id/bank-guarantees",component:xe},{path:"/deal/:id/limits",component:Pe},{path:"/deal/:id/objects",component:Fe},{path:"/deal/:id/objects/:idObject/",component:He,children:[{path:"/deal/:id/objects/:idObject/about",component:Ve},{path:"/deal/:id/objects/:idObject/watchers",component:ia},{path:"/deal/:id/objects/:idObject/UP",component:ua},{path:"/deal/:id/objects/:idObject/USh",component:ma},{path:"/deal/:id/objects/:idObject/UH",component:xa}]},{path:"/deal/:id/payment-stages",component:$a},{path:"/deal/:id/key-events",component:Pa},{path:"/deal/:id/claim-work",component:Fa},{path:"/deal/:id/judical-work",component:Ha},{path:"/deal/:id/cash-execution",component:Va}]}]}]}),tn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("app-header",[t.headerButtons?a("header-buttons",{attrs:{isAdmin:t.isAdmin},on:{buttonPressed:t.headerButtonsPressed}}):t._e()],1),a("router-view",{on:{update:t.update}})],1)},en=[],an=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"header"},[a("h1",{staticClass:"logo"},[t._v(" CLERC ")]),a("div",{staticClass:"header-wrapper"},[t._t("default")],2)])},nn=[],dn={},rn=dn,sn=(a("aa2e"),Object(f["a"])(rn,an,nn,!1,null,null,null)),on=sn.exports,ln=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header_buttons"},[this.isAdmin?a("button",{staticClass:"header_button header_button__admin",attrs:{title:"Пользователи"},on:{click:function(e){return t.admin()}}}):t._e(),this.isAdmin?a("span",{staticClass:"header_separator"}):t._e(),a("button",{staticClass:"header_button header_button__logout",attrs:{title:"Выйти"},on:{click:function(e){return t.logOut()}}})])},un=[],cn={props:["isAdmin"],data:function(){return{}},methods:{admin:function(){this.$emit("buttonPressed","admin")},logOut:function(){this.$emit("buttonPressed","logOut")}}},hn=cn,pn=(a("f49c"),Object(f["a"])(hn,ln,un,!1,null,null,null)),fn=pn.exports;n["a"].component("app-header",on),n["a"].component("header-buttons",fn);var vn={name:"app",data:function(){return{headerButtons:!1,isAdmin:!1}},methods:{update:function(t){switch(t){case"logIn":this.headerButtons=!0,this.isAdmin=!0;break;case"watcher":this.headerButtons=!0,this.isAdmin=!1;break;case"logOut":sessionStorage.clear(),this.headerButtons=!1;break}},headerButtonsPressed:function(t){switch(t){case"admin":Za.push("/users");break;case"logOut":this.update("logOut"),Za.push("/login");break}}},mounted:function(){sessionStorage.getItem("role")&&(this.headerButtons=!0)}},mn=vn,bn=(a("5c0b"),Object(f["a"])(mn,tn,en,!1,null,null,null)),gn=bn.exports;null==sessionStorage.getItem("token_type")?Za.push("/login"):"/"==window.location.pathname?1==sessionStorage.getItem("role")?Za.push("/main"):Za.push("/watcher"):1==sessionStorage.getItem("role")?window.location.pathname.indexOf("watcher")>=0&&Za.push("/main"):-1==window.location.pathname.indexOf("watcher")&&Za.push("/watcher"),new n["a"]({el:"#app",router:Za,render:function(t){return t(gn)}})},"594c":function(t,e,a){},"5c0b":function(t,e,a){"use strict";var n=a("9c0c"),i=a.n(n);i.a},"640a":function(t,e,a){"use strict";var n=a("2e56"),i=a.n(n);i.a},"66be":function(t,e,a){},6705:function(t,e,a){},"6a7c":function(t,e,a){},"6dc4":function(t,e,a){},"6fe9":function(t,e,a){"use strict";var n=a("af61"),i=a.n(n);i.a},"70cd":function(t,e,a){"use strict";var n=a("4934"),i=a.n(n);i.a},7596:function(t,e,a){"use strict";var n=a("6705"),i=a.n(n);i.a},7650:function(t,e,a){"use strict";var n=a("5259"),i=a.n(n);i.a},"7b2a":function(t,e,a){},"7f8f":function(t,e,a){"use strict";var n=a("ec9a"),i=a.n(n);i.a},8201:function(t,e,a){},"8fbf":function(t,e,a){"use strict";var n=a("6a7c"),i=a.n(n);i.a},"91d0":function(t,e,a){},9991:function(t,e,a){},"9a38":function(t,e,a){},"9c0c":function(t,e,a){},aa2e:function(t,e,a){"use strict";var n=a("9a38"),i=a.n(n);i.a},af61:function(t,e,a){},b08b:function(t,e,a){"use strict";var n=a("b9da"),i=a.n(n);i.a},b9da:function(t,e,a){},be4e:function(t,e,a){"use strict";var n=a("8201"),i=a.n(n);i.a},c2d7:function(t,e,a){"use strict";var n=a("d75d"),i=a.n(n);i.a},c466:function(t,e,a){"use strict";var n=a("f8ea"),i=a.n(n);i.a},c5e7:function(t,e,a){"use strict";var n=a("91d0"),i=a.n(n);i.a},c63c:function(t,e,a){"use strict";var n=a("7b2a"),i=a.n(n);i.a},cd6e:function(t,e,a){"use strict";var n=a("594c"),i=a.n(n);i.a},d75d:function(t,e,a){},ec9a:function(t,e,a){},ed45:function(t,e,a){},f1fc:function(t,e,a){"use strict";var n=a("f246"),i=a.n(n);i.a},f246:function(t,e,a){},f444:function(t,e,a){"use strict";var n=a("9991"),i=a.n(n);i.a},f49c:function(t,e,a){"use strict";var n=a("ed45"),i=a.n(n);i.a},f8ea:function(t,e,a){}});
//# sourceMappingURL=app.48a703f7.js.map